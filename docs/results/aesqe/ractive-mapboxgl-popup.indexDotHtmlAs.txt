b'<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml">\n <head>\n  <meta charset="utf-8"/>\n  <title>\n   Ractive - Mapbox GL popup component\n  </title>\n  <link href="https://api.mapbox.com/mapbox-gl-js/v0.18.0/mapbox-gl.css" rel="stylesheet"/>\n  <script src="https://api.mapbox.com/mapbox-gl-js/v0.18.0/mapbox-gl.js" type="text/javascript">\n  </script>\n  <script src="http://cdn.ractivejs.org/edge/ractive.min.js" type="text/javascript">\n  </script>\n  <style type="text/css">\n  </style>\n  <script src="https://cdn.rawgit.com/aesqe/ractive-load/master/dist/ractive-load.umd.js" type="text/javascript">\n  </script>\n </head>\n <body>\n  <div id="demo">\n   <div class="mapboxgl-map" id="mapbox" style="width: 750px; height: 400px;">\n    <div class="mapboxgl-canvas-container mapboxgl-interactive">\n     <canvas class="mapboxgl-canvas" height="400" style="position: absolute; width: 750px; height: 400px;" tabindex="0" width="750">\n     </canvas>\n    </div>\n    <div class="mapboxgl-control-container">\n     <div class="mapboxgl-ctrl-top-left">\n     </div>\n     <div class="mapboxgl-ctrl-top-right">\n     </div>\n     <div class="mapboxgl-ctrl-bottom-left">\n     </div>\n     <div class="mapboxgl-ctrl-bottom-right">\n      <div class="mapboxgl-ctrl-attrib mapboxgl-ctrl">\n       <a href="https://www.mapbox.com/about/maps/" target="_blank">\n        \xc2\xa9 Mapbox\n       </a>\n       <a href="http://www.openstreetmap.org/about/" target="_blank">\n        \xc2\xa9 OpenStreetMap\n       </a>\n       <a class="mapbox-improve-map" href="https://www.mapbox.com/map-feedback/#/-77.04/38.907/12" target="_blank">\n        Improve this map\n       </a>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <script id="template" type="text/ractive">\n   &lt;div id="mapbox" style="width: 750px; height: 400px"&gt;\n\t\t\t{{#if selectedMarker.marker !== null}}\n\t\t\t\t{{#with selectedMarker}}\n\t\t\t\t\t&lt;mapboxglPopup \n\t\t\t\t\t\tmarker="{{marker}}"\n\t\t\t\t\t\tmap="{{map}}" \n\t\t\t\t\t\tpopupContent="{{marker.properties.description}}" \n\t\t\t\t\t\tpartialName="popupTemplate" /&gt;\n\t\t\t\t{{/with}}\n\t\t\t{{/if}}\n\t\t&lt;/div&gt;\n\n\t\t{{#partial popupTemplate}}\n\t\t\t&lt;div class="marker-description"&gt;\n\t\t\t\t{{popupContent}}\n\t\t\t&lt;/div&gt;\n\t\t{{/partial}}\n  </script>\n  <script type="text/javascript">\n   mapboxgl.accessToken = "pk.eyJ1IjoiYWVzcWUiLCJhIjoiY2lmNGVxYnNnMDNrenJya2xzbmQ4M281bCJ9.GfMJ8R2NX1dDcc9Hs2PO3A";\n\n\t\tvar app;\n\t\tvar markers = [\n\t\t\t{\n\t\t\t\t"type": "Feature",\n\t\t\t\t"properties": {\n\t\t\t\t\t"marker-symbol": "theatre",\n\t\t\t\t\t"description": "I\'m a theatre"\n\t\t\t\t},\n\t\t\t\t"geometry": {\n\t\t\t\t\t"type": "Point",\n\t\t\t\t\t"coordinates": [-77.003168, 38.894651]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t"type": "Feature",\n\t\t\t\t"properties": {\n\t\t\t\t\t"marker-symbol": "bar",\n\t\t\t\t\t"description": "I\'m a bar"\n\t\t\t\t},\n\t\t\t\t"geometry": {\n\t\t\t\t\t"type": "Point",\n\t\t\t\t\t"coordinates": [-77.090372, 38.881189]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t"type": "Feature",\n\t\t\t\t"properties": {\n\t\t\t\t\t"marker-symbol": "bicycle",\n\t\t\t\t\t"description": "I am bicycle?"\n\t\t\t\t},\n\t\t\t\t"geometry": {\n\t\t\t\t\t"type": "Point",\n\t\t\t\t\t"coordinates": [-77.052477, 38.943951]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t"type": "Feature",\n\t\t\t\t"properties": {\n\t\t\t\t\t"marker-symbol": "music",\n\t\t\t\t\t"description": "Party music!"\n\t\t\t\t},\n\t\t\t\t"geometry": {\n\t\t\t\t\t"type": "Point",\n\t\t\t\t\t"coordinates": [-77.031706, 38.914581]\n\t\t\t\t}\n\t\t\t}];\n\n\t\tRactive.load("ractive-mapboxgl-popup.html").then(function(mapboxglPopup)\n\t\t{\n\t\t\tapp = new Ractive({\n\t\t\t\tel: "#demo",\n\t\t\t\ttemplate: "#template",\n\n\t\t\t\tcomponents: {\n\t\t\t\t\tmapboxglPopup: mapboxglPopup\n\t\t\t\t},\n\n\t\t\t\tdata: {\n\t\t\t\t\tmap: null,\n\t\t\t\t\tselectedMarker: null\n\t\t\t\t},\n\n\t\t\t\tonconfig: function()\n\t\t\t\t{\n\t\t\t\t\tthis.on("selectMarker", this.selectMarker);\n\t\t\t\t\tthis.set("markers", markers);\n\t\t\t\t},\n\n\t\t\t\tonrender: function()\n\t\t\t\t{\n\t\t\t\t\tvar map = new mapboxgl.Map({\n\t\t\t\t\t\tcontainer: "mapbox",\n\t\t\t\t\t\tstyle: "mapbox://styles/mapbox/streets-v8",\n\t\t\t\t\t\tcenter: [-77.04, 38.907],\n\t\t\t\t\t\tzoom: 11.15\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.on("style.load", this.onMapStyleLoaded.bind(this));\n\n\t\t\t\t\tthis.set("map", map);\n\t\t\t\t},\n\n\t\t\t\tonMapStyleLoaded: function()\n\t\t\t\t{\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tvar map = this.get("map");\n\n\t\t\t\t\tthis.addMarkersLayer(this.get("markers"));\n\n\t\t\t\t\tmap.on("click", function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar marker = null;\n\t\t\t\t\t\tvar features = map.queryRenderedFeatures(e.point, {\n\t\t\t\t\t\t\tradius: 7.5,\n\t\t\t\t\t\t\tincludeGeometry: true,\n\t\t\t\t\t\t\tlayers: ["markers"]\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif( features.length ) {\n\t\t\t\t\t\t\tmarker = self.findClosestMarker(features[0]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tself.selectMarker(marker);\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.on("mousemove", function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar features = map.queryRenderedFeatures(e.point, {\n\t\t\t\t\t\t\tradius: 7.5,\n\t\t\t\t\t\t\tincludeGeometry: true,\n\t\t\t\t\t\t\tlayers: ["markers"]\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tmap.getCanvas().style.cursor = (features.length) ? "pointer" : "";\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\taddMarkersLayer: function( markers )\n\t\t\t\t{\n\t\t\t\t\tvar map = this.get("map");\n\n\t\t\t\t\tmap.addSource("markers", {\n\t\t\t\t\t\t"type": "geojson",\n\t\t\t\t\t\t"data": {\n\t\t\t\t\t\t\t"type": "FeatureCollection",\n\t\t\t\t\t\t\t"features": markers\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.addLayer({\n\t\t\t\t\t\t"id": "markers",\n\t\t\t\t\t\t"type": "symbol",\n\t\t\t\t\t\t"source": "markers",\n\t\t\t\t\t\t"interactive": true,\n\t\t\t\t\t\t"layout": {\n\t\t\t\t\t\t\t"icon-image": "{marker-symbol}-15",\n\t\t\t\t\t\t\t"text-field": "{title}",\n\t\t\t\t\t\t\t"text-font": ["Open Sans Semibold", "Arial Unicode MS Bold"],\n\t\t\t\t\t\t\t"text-offset": [0, 0.6],\n\t\t\t\t\t\t\t"text-anchor": "top"\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tselectMarker: function( marker )\n\t\t\t\t{\n\t\t\t\t\tthis.set("selectedMarker", {\n\t\t\t\t\t\tmarker: marker,\n\t\t\t\t\t\tmap: this.get("map")\n\t\t\t\t\t});\n\n\t\t\t\t\tif( marker !== null )\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.findAllComponents("mapboxglPopup").forEach(function(c){\n\t\t\t\t\t\t\tc.updatePosition();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tgetDistance: function ( a, b )\n\t\t\t\t{\n\t\t\t\t\treturn Math.pow(Math.abs(a[0] - b[0]), 2) + Math.pow(Math.abs(a[1] - b[1]), 2);\n\t\t\t\t},\n\n\t\t\t\tfindClosestMarker: function( feature )\n\t\t\t\t{\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tvar featCoords = feature.geometry.coordinates;\n\t\t\t\t\tvar closest = this.get("markers").reduce(function(prev, curr, i, arr)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar distance = self.getDistance(featCoords, curr.geometry.coordinates);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif( prev.distance &gt; distance ) {\n\t\t\t\t\t\t\treturn {marker: curr, distance: distance};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn prev;\n\t\t\t\t\t}, {marker: null, distance: Number.POSITIVE_INFINITY});\n\n\t\t\t\t\treturn closest.marker;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n  </script>\n </body>\n</html>'b'<!DOCTYPE html>\n<html xmlns="http://www.w3.org/1999/xhtml">\n <head>\n  <meta charset="utf-8"/>\n  <title>\n   Ractive - Mapbox GL popup component\n  </title>\n  <link href="https://api.mapbox.com/mapbox-gl-js/v0.18.0/mapbox-gl.css" rel="stylesheet"/>\n  <script src="https://api.mapbox.com/mapbox-gl-js/v0.18.0/mapbox-gl.js" type="text/javascript">\n  </script>\n  <script src="http://cdn.ractivejs.org/edge/ractive.min.js" type="text/javascript">\n  </script>\n  <style type="text/css">\n  </style>\n  <script src="https://cdn.rawgit.com/aesqe/ractive-load/master/dist/ractive-load.umd.js" type="text/javascript">\n  </script>\n </head>\n <body>\n  <div id="demo">\n   <div class="mapboxgl-map" id="mapbox" style="width: 750px; height: 400px;">\n    <div class="mapboxgl-canvas-container mapboxgl-interactive">\n     <canvas class="mapboxgl-canvas" height="400" style="position: absolute; width: 750px; height: 400px;" tabindex="0" width="750">\n     </canvas>\n    </div>\n    <div class="mapboxgl-control-container">\n     <div class="mapboxgl-ctrl-top-left">\n     </div>\n     <div class="mapboxgl-ctrl-top-right">\n     </div>\n     <div class="mapboxgl-ctrl-bottom-left">\n     </div>\n     <div class="mapboxgl-ctrl-bottom-right">\n      <div class="mapboxgl-ctrl-attrib mapboxgl-ctrl">\n       <a href="https://www.mapbox.com/about/maps/" target="_blank">\n        \xc2\xa9 Mapbox\n       </a>\n       <a href="http://www.openstreetmap.org/about/" target="_blank">\n        \xc2\xa9 OpenStreetMap\n       </a>\n       <a class="mapbox-improve-map" href="https://www.mapbox.com/map-feedback/#/-77.04/38.907/12" target="_blank">\n        Improve this map\n       </a>\n      </div>\n     </div>\n    </div>\n   </div>\n  </div>\n  <script id="template" type="text/ractive">\n   &lt;div id="mapbox" style="width: 750px; height: 400px"&gt;\n\t\t\t{{#if selectedMarker.marker !== null}}\n\t\t\t\t{{#with selectedMarker}}\n\t\t\t\t\t&lt;mapboxglPopup \n\t\t\t\t\t\tmarker="{{marker}}"\n\t\t\t\t\t\tmap="{{map}}" \n\t\t\t\t\t\tpopupContent="{{marker.properties.description}}" \n\t\t\t\t\t\tpartialName="popupTemplate" /&gt;\n\t\t\t\t{{/with}}\n\t\t\t{{/if}}\n\t\t&lt;/div&gt;\n\n\t\t{{#partial popupTemplate}}\n\t\t\t&lt;div class="marker-description"&gt;\n\t\t\t\t{{popupContent}}\n\t\t\t&lt;/div&gt;\n\t\t{{/partial}}\n  </script>\n  <script type="text/javascript">\n   mapboxgl.accessToken = "pk.eyJ1IjoiYWVzcWUiLCJhIjoiY2lmNGVxYnNnMDNrenJya2xzbmQ4M281bCJ9.GfMJ8R2NX1dDcc9Hs2PO3A";\n\n\t\tvar app;\n\t\tvar markers = [\n\t\t\t{\n\t\t\t\t"type": "Feature",\n\t\t\t\t"properties": {\n\t\t\t\t\t"marker-symbol": "theatre",\n\t\t\t\t\t"description": "I\'m a theatre"\n\t\t\t\t},\n\t\t\t\t"geometry": {\n\t\t\t\t\t"type": "Point",\n\t\t\t\t\t"coordinates": [-77.003168, 38.894651]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t"type": "Feature",\n\t\t\t\t"properties": {\n\t\t\t\t\t"marker-symbol": "bar",\n\t\t\t\t\t"description": "I\'m a bar"\n\t\t\t\t},\n\t\t\t\t"geometry": {\n\t\t\t\t\t"type": "Point",\n\t\t\t\t\t"coordinates": [-77.090372, 38.881189]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t"type": "Feature",\n\t\t\t\t"properties": {\n\t\t\t\t\t"marker-symbol": "bicycle",\n\t\t\t\t\t"description": "I am bicycle?"\n\t\t\t\t},\n\t\t\t\t"geometry": {\n\t\t\t\t\t"type": "Point",\n\t\t\t\t\t"coordinates": [-77.052477, 38.943951]\n\t\t\t\t}\n\t\t\t},\n\t\t\t{\n\t\t\t\t"type": "Feature",\n\t\t\t\t"properties": {\n\t\t\t\t\t"marker-symbol": "music",\n\t\t\t\t\t"description": "Party music!"\n\t\t\t\t},\n\t\t\t\t"geometry": {\n\t\t\t\t\t"type": "Point",\n\t\t\t\t\t"coordinates": [-77.031706, 38.914581]\n\t\t\t\t}\n\t\t\t}];\n\n\t\tRactive.load("ractive-mapboxgl-popup.html").then(function(mapboxglPopup)\n\t\t{\n\t\t\tapp = new Ractive({\n\t\t\t\tel: "#demo",\n\t\t\t\ttemplate: "#template",\n\n\t\t\t\tcomponents: {\n\t\t\t\t\tmapboxglPopup: mapboxglPopup\n\t\t\t\t},\n\n\t\t\t\tdata: {\n\t\t\t\t\tmap: null,\n\t\t\t\t\tselectedMarker: null\n\t\t\t\t},\n\n\t\t\t\tonconfig: function()\n\t\t\t\t{\n\t\t\t\t\tthis.on("selectMarker", this.selectMarker);\n\t\t\t\t\tthis.set("markers", markers);\n\t\t\t\t},\n\n\t\t\t\tonrender: function()\n\t\t\t\t{\n\t\t\t\t\tvar map = new mapboxgl.Map({\n\t\t\t\t\t\tcontainer: "mapbox",\n\t\t\t\t\t\tstyle: "mapbox://styles/mapbox/streets-v8",\n\t\t\t\t\t\tcenter: [-77.04, 38.907],\n\t\t\t\t\t\tzoom: 11.15\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.on("style.load", this.onMapStyleLoaded.bind(this));\n\n\t\t\t\t\tthis.set("map", map);\n\t\t\t\t},\n\n\t\t\t\tonMapStyleLoaded: function()\n\t\t\t\t{\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tvar map = this.get("map");\n\n\t\t\t\t\tthis.addMarkersLayer(this.get("markers"));\n\n\t\t\t\t\tmap.on("click", function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar marker = null;\n\t\t\t\t\t\tvar features = map.queryRenderedFeatures(e.point, {\n\t\t\t\t\t\t\tradius: 7.5,\n\t\t\t\t\t\t\tincludeGeometry: true,\n\t\t\t\t\t\t\tlayers: ["markers"]\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tif( features.length ) {\n\t\t\t\t\t\t\tmarker = self.findClosestMarker(features[0]);\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\tself.selectMarker(marker);\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.on("mousemove", function(e)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar features = map.queryRenderedFeatures(e.point, {\n\t\t\t\t\t\t\tradius: 7.5,\n\t\t\t\t\t\t\tincludeGeometry: true,\n\t\t\t\t\t\t\tlayers: ["markers"]\n\t\t\t\t\t\t});\n\n\t\t\t\t\t\tmap.getCanvas().style.cursor = (features.length) ? "pointer" : "";\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\taddMarkersLayer: function( markers )\n\t\t\t\t{\n\t\t\t\t\tvar map = this.get("map");\n\n\t\t\t\t\tmap.addSource("markers", {\n\t\t\t\t\t\t"type": "geojson",\n\t\t\t\t\t\t"data": {\n\t\t\t\t\t\t\t"type": "FeatureCollection",\n\t\t\t\t\t\t\t"features": markers\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tmap.addLayer({\n\t\t\t\t\t\t"id": "markers",\n\t\t\t\t\t\t"type": "symbol",\n\t\t\t\t\t\t"source": "markers",\n\t\t\t\t\t\t"interactive": true,\n\t\t\t\t\t\t"layout": {\n\t\t\t\t\t\t\t"icon-image": "{marker-symbol}-15",\n\t\t\t\t\t\t\t"text-field": "{title}",\n\t\t\t\t\t\t\t"text-font": ["Open Sans Semibold", "Arial Unicode MS Bold"],\n\t\t\t\t\t\t\t"text-offset": [0, 0.6],\n\t\t\t\t\t\t\t"text-anchor": "top"\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t},\n\n\t\t\t\tselectMarker: function( marker )\n\t\t\t\t{\n\t\t\t\t\tthis.set("selectedMarker", {\n\t\t\t\t\t\tmarker: marker,\n\t\t\t\t\t\tmap: this.get("map")\n\t\t\t\t\t});\n\n\t\t\t\t\tif( marker !== null )\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.findAllComponents("mapboxglPopup").forEach(function(c){\n\t\t\t\t\t\t\tc.updatePosition();\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t},\n\n\t\t\t\tgetDistance: function ( a, b )\n\t\t\t\t{\n\t\t\t\t\treturn Math.pow(Math.abs(a[0] - b[0]), 2) + Math.pow(Math.abs(a[1] - b[1]), 2);\n\t\t\t\t},\n\n\t\t\t\tfindClosestMarker: function( feature )\n\t\t\t\t{\n\t\t\t\t\tvar self = this;\n\t\t\t\t\tvar featCoords = feature.geometry.coordinates;\n\t\t\t\t\tvar closest = this.get("markers").reduce(function(prev, curr, i, arr)\n\t\t\t\t\t{\n\t\t\t\t\t\tvar distance = self.getDistance(featCoords, curr.geometry.coordinates);\n\t\t\t\t\t\t\n\t\t\t\t\t\tif( prev.distance &gt; distance ) {\n\t\t\t\t\t\t\treturn {marker: curr, distance: distance};\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn prev;\n\t\t\t\t\t}, {marker: null, distance: Number.POSITIVE_INFINITY});\n\n\t\t\t\t\treturn closest.marker;\n\t\t\t\t}\n\t\t\t});\n\t\t});\n  </script>\n </body>\n</html>'
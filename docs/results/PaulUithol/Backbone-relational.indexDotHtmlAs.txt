b'<html xmlns="http://www.w3.org/1999/html">\n <head>\n  <meta content="text/html;charset=utf-8" http-equiv="content-type"/>\n  <meta content="chrome=1" http-equiv="X-UA-Compatible"/>\n  <meta content="width=device-width" name="viewport"/>\n  <link href="static/images/favicon.ico" rel="icon"/>\n  <link href="http://fonts.googleapis.com/css?family=Arimo" rel="stylesheet" type="text/css"/>\n  <link href="static/css/style.css" rel="stylesheet" type="text/css"/>\n  <title>\n   Backbone-relational.js\n  </title>\n  <!--[if lt IE 9]>\n\t<script>\n\t\tdocument.createElement(\'header\');\n\t\tdocument.createElement(\'nav\');\n\t\tdocument.createElement(\'section\');\n\t\tdocument.createElement(\'article\');\n\t\tdocument.createElement(\'aside\');\n\t\tdocument.createElement(\'footer\');\n\t\tdocument.createElement(\'hgroup\');\n\t</script>\n\t<![endif]-->\n </head>\n <body>\n  <div id="sidebar">\n   <a class="toc_title" href="#">\n    Backbone-relational.js\n    <span class="version">\n     (0.10.0)\n    </span>\n   </a>\n   <ul>\n    <li class="link_out">\n     <a href="https://github.com/PaulUithol/Backbone-relational">\n      GitHub Repository\n     </a>\n    </li>\n   </ul>\n   <a class="toc_title" href="#introduction">\n    Introduction\n   </a>\n   <a class="toc_title" href="#installation">\n    Installation\n   </a>\n   <a class="toc_title" href="#RelationalModel">\n    Backbone.RelationalModel\n   </a>\n   <ul>\n    <li>\n     <a href="#RelationalModel-relations">\n      relations\n     </a>\n     <ul>\n      <li>\n       <a href="#relations-key">\n        key\n       </a>\n      </li>\n      <li>\n       <a href="#relations-relatedModel">\n        relatedModel\n       </a>\n      </li>\n      <li>\n       <a href="#relations-type">\n        type\n       </a>\n      </li>\n      <li>\n       <a href="#relations-includeInJSON">\n        includeInJSON\n       </a>\n      </li>\n      <li>\n       <a href="#relations-autoFetch">\n        autoFetch\n       </a>\n      </li>\n      <li>\n       <a href="#relations-collectionType">\n        collectionType\n       </a>\n      </li>\n      <li>\n       <a href="#relations-collectionKey">\n        collectionKey\n       </a>\n      </li>\n      <li>\n       <a href="#relations-collectionOptions">\n        collectionOptions\n       </a>\n      </li>\n      <li>\n       <a href="#relations-createModels">\n        createModels\n       </a>\n      </li>\n      <li>\n       <a href="#relations-keySource">\n        keySource\n       </a>\n      </li>\n      <li>\n       <a href="#relations-keyDestination">\n        keyDestination\n       </a>\n      </li>\n      <li>\n       <a href="#relations-parse">\n        parse\n       </a>\n      </li>\n      <li>\n       <a href="#relations-reverseRelation">\n        reverseRelation\n       </a>\n      </li>\n     </ul>\n    </li>\n   </ul>\n   <ul>\n    <li>\n     <a href="#RelationalModel-subModelTypes">\n      subModelTypes\n     </a>\n    </li>\n    <li>\n     <a href="#RelationalModel-subModelTypeAttribute">\n      subModelTypeAttribute\n     </a>\n    </li>\n   </ul>\n   <ul>\n    <li>\n     <a href="#RelationalModel-getAsync">\n      getAsync\n     </a>\n    </li>\n    <li>\n     <a href="#RelationalModel-getIdsToFetch">\n      getIdsToFetch\n     </a>\n    </li>\n    <li>\n     <a href="#RelationalModel-getRelation">\n      getRelation\n     </a>\n    </li>\n    <li>\n     <a href="#RelationalModel-getRelations">\n      getRelations\n     </a>\n    </li>\n    <li>\n     <a href="#RelationalModel-set">\n      set\n     </a>\n    </li>\n    <li>\n     <a href="#RelationalModel-toJSON">\n      toJSON\n     </a>\n    </li>\n   </ul>\n   <ul>\n    <li>\n     <a href="#RelationalModel-setup">\n      setup\n     </a>\n    </li>\n    <li>\n     <a href="#RelationalModel-build">\n      build\n     </a>\n    </li>\n    <li>\n     <a href="#RelationalModel-findOrCreate">\n      findOrCreate\n     </a>\n    </li>\n    <li>\n     <a href="#RelationalModel-find">\n      find\n     </a>\n    </li>\n    <li>\n     <a href="#RelationalModel-findModel">\n      findModel\n     </a>\n    </li>\n   </ul>\n   <ul>\n    <li>\n     <a href="#RelationalModel-events">\n      <strong>\n       Catalog of Events\n      </strong>\n     </a>\n    </li>\n   </ul>\n   <a class="toc_title" href="#Relation">\n    Backbone.Relation\n   </a>\n   <ul>\n    <li>\n     <a href="#Relation-HasOne">\n      HasOne\n     </a>\n    </li>\n    <li>\n     <a href="#Relation-HasMany">\n      HasMany\n     </a>\n    </li>\n   </ul>\n   <a class="toc_title" href="#Store">\n    Backbone.Store\n   </a>\n   <ul>\n    <li>\n     <a href="#Store-addModelScope">\n      addModelScope\n     </a>\n    </li>\n    <li>\n     <a href="#Store-removeModelScope">\n      removeModelScope\n     </a>\n    </li>\n    <li>\n     <a href="#Store-reset">\n      reset\n     </a>\n    </li>\n   </ul>\n   <a class="toc_title" href="#examples">\n    Examples\n   </a>\n   <a class="toc_title" href="#change-log">\n    Change Log\n   </a>\n   <a class="toc_title" href="#under-the-hood">\n    Under the Hood\n   </a>\n  </div>\n  <div class="container">\n   <section>\n    <h1>\n     Backbone-relational.js\n    </h1>\n    <p>\n     When developing any medium to large-scale web application, you often get to the point where\n\t\t\tan action by a user can cause a number of different models to change on the client and the server.\n    </p>\n    <p>\n     You can try to keep updating both sides of a relation manually for every action, and individually call\n     <q>\n      <a href="http://backbonejs.org/#Model-save">\n       save\n      </a>\n     </q>\n     or\n     <q>\n      <a href="http://backbonejs.org/#Model-fetch">\n       fetch\n      </a>\n     </q>\n     on each of the changed models to sync with the server, but that quickly turns into a tedious process and\n\t\t\tresults in multiple requests.\n    </p>\n    <p>\n     Using Backbone-relational, we can configure relationships between our models, and sync the model and all of its related models with a single\n\t\t\tcall to\n     <q>\n      <a href="http://backbonejs.org/#Model-save">\n       save\n      </a>\n     </q>\n     ,\n     <q>\n      <a href="#RelationalModel-getAsync">\n       getAsync\n      </a>\n     </q>\n     or\n     <q>\n      <a href="http://backbonejs.org/#Model-fetch">\n       fetch()\n      </a>\n     </q>\n     after setting up a model\'s\n     <q>\n      <a href="#RelationalModel-relations">\n       relations\n      </a>\n     </q>\n     .\n    </p>\n    <p>\n     Backbone-relational is hosted on\n     <a href="https://github.com/PaulUithol/Backbone-relational">\n      GitHub\n     </a>\n     ,\n\t\t\tand is available under the\n     <a href="https://github.com/PaulUithol/Backbone-relational/blob/master/LICENSE.txt">\n      MIT license\n     </a>\n     .\n    </p>\n    <p>\n     Thanks to\n     <a href="http://progressiveplanning.com">\n      Progressive Planning\n     </a>\n     for allowing me the time to\n\t\t\twork on Backbone-relational!\n    </p>\n   </section>\n   <section id="downloads">\n    <h2>\n     Downloads &amp; Dependencies\n     <span class="interface" style="padding-left: 7px; font-size:11px; font-weight: normal;">\n      (Right-click, and use "Save As")\n     </span>\n    </h2>\n    <table>\n     <tbody>\n      <tr>\n       <td>\n        <a class="punch" href="https://raw.githubusercontent.com/PaulUithol/Backbone-relational/a7634e7d9deac64e3da455a3fde13b96ae253612/backbone-relational.js">\n         Latest Release (0.10.0)\n        </a>\n       </td>\n       <td class="text">\n        <i>\n         ~70kb. Full source, uncompressed, lots of comments.\n        </i>\n       </td>\n      </tr>\n      <tr>\n       <td>\n        <a class="punch" href="https://raw.githubusercontent.com/PaulUithol/Backbone-relational/master/backbone-relational.js">\n         Edge Version\n        </a>\n       </td>\n      </tr>\n     </tbody>\n    </table>\n    <p>\n     Backbone-relational depends on\n     <a href="http://backbonejs.org/">\n      Backbone.js\n     </a>\n     <small>\n      (&gt;= 1.2.1)\n     </small>\n     ,\n\t\t\twhich itself requires\n     <a href="http://underscorejs.org">\n      Underscore.js\n     </a>\n     <small>\n      (&gt; 1.7.0)\n     </small>\n     and\n     <a href="http://jquery.com">\n      jQuery\n     </a>\n     <small>\n      (&gt; 1.7.0)\n     </small>\n     or\n     <a href="http://zeptojs.com/">\n      Zepto\n     </a>\n     .\n    </p>\n   </section>\n   <section id="introduction">\n    <h2>\n     Introduction\n    </h2>\n    <p>\n     Backbone-relational.js provides one-to-one, one-to-many and many-to-one relations\n\t\t\tbetween models for Backbone. To use relations, extend\n     <a href="#RelationalModel">\n      <strong>\n       Backbone.RelationalModel\n      </strong>\n     </a>\n     (instead of a regular\n     <a href="http://backbonejs.org/#Model">\n      Backbone.Model\n     </a>\n     ) and define a\n     <a href="#RelationalModel-relations">\n      <q>\n       relations\n      </q>\n     </a>\n     property, containing an array of option objects.\n\t\t\tEach relation must define (at least) the\n     <a href="#relations-type">\n      <q>\n       type\n      </q>\n     </a>\n     ,\n     <a href="#relations-key">\n      <q>\n       key\n      </q>\n     </a>\n     ,\n\t\t\tand\n     <a href="#relations-relatedModel">\n      <q>\n       relatedModel\n      </q>\n     </a>\n     . Available relation types are\n     <a href="#Relation-HasOne">\n      <q>\n       Backbone.HasOne\n      </q>\n     </a>\n     and\n     <a href="#Relation-HasMany">\n      <q>\n       Backbone.HasMany\n      </q>\n     </a>\n     .\n    </p>\n    <p>\n     Backbone-relational\'s main features include:\n    </p>\n    <ul>\n     <li>\n      Bidirectional relations, which notify related models of changes through events.\n     </li>\n     <li>\n      Control how relations are serialized using the\n      <a href="#relations-includeInJSON">\n       <q>\n        includeInJSON\n       </q>\n      </a>\n      option.\n     </li>\n     <li>\n      Automatically convert nested objects in a model\'s attributes into model instances (using the\n      <a href="#relations-createModels">\n       <q>\n        createModels\n       </q>\n      </a>\n      option, which is\n      <q>\n       true\n      </q>\n      by default).\n     </li>\n     <li>\n      Lazily retrieve a set of related models through the\n      <a href="#RelationalModel-getAsync">\n       <q>\n        getAsync\n       </q>\n      </a>\n      method.\n     </li>\n     <li>\n      Determine the type of HasMany collections with\n      <a href="#relations-collectionType">\n       <q>\n        collectionType\n       </q>\n      </a>\n      .\n     </li>\n    </ul>\n    <p>\n     You can also bind new events to a\n     <strong>\n      Backbone.RelationalModel\n     </strong>\n     for an:\n    </p>\n    <ul>\n     <li>\n      <strong>\n       addition\n      </strong>\n      to a HasMany relation with\n      <a href="#RelationalModel-events">\n       add:&lt;key&gt;\n      </a>\n      .\n     </li>\n     <li>\n      <strong>\n       removal\n      </strong>\n      from a HasMany relation with\n      <a href="#RelationalModel-events">\n       remove:&lt;key&gt;\n      </a>\n      .\n     </li>\n     <li>\n      <strong>\n       reset\n      </strong>\n      of a HasMany relation with\n      <a href="#RelationalModel-events">\n       reset:&lt;key&gt;\n      </a>\n      .\n     </li>\n     <li>\n      <strong>\n       changes\n      </strong>\n      to the contents of a HasMany or HasOne relations with\n      <a href="#RelationalModel-events">\n       change:\n\t\t\t\t&lt;key&gt;\n      </a>\n      .\n     </li>\n    </ul>\n   </section>\n   <section id="installation">\n    <h2>\n     Installation\n    </h2>\n    <p>\n     Backbone-relational depends on\n     <a href="http://backbonejs.org/">\n      Backbone.js\n     </a>\n     (and thus on\n     <a href="http://underscorejs.org">\n      Underscore.js\n     </a>\n     ). Include Backbone-relational right after Backbone\n\t\t\tand Underscore:\n    </p>\n    <pre class="language-markup"><code class="language-markup"><span class="token script"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./js/underscore.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>\n<span class="token script"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./js/backbone.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>\n<span class="token script"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>text/javascript<span class="token punctuation">"</span></span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>./js/backbone-relational.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span>\n</code></pre>\n    <p class="notice">\n     Note for\n     <strong>\n      CoffeeScript\n     </strong>\n     users: due to the way the\n     <q>\n      extends\n     </q>\n     keyword is implemented in\n\t\t\tCoffeeScript, you may have to make an extra call to\n     <a href="#RelationalModel-setup">\n      <q>\n       setup\n      </q>\n     </a>\n     for\n\t\t\tyour models. See the\n     <a href="#RelationalModel-setup">\n      <q>\n       setup\n      </q>\n     </a>\n     documentation for details.\n    </p>\n   </section>\n   <section id="RelationalModel">\n    <h2>\n     Backbone.RelationalModel\n    </h2>\n    <p>\n     When using Backbone-relational, each model defining (or receiving)\n     <q>\n      relations\n     </q>\n     must extend\n     <strong>\n      Backbone.RelationalModel\n     </strong>\n     in order to function.\n     <strong>\n      Backbone.RelationalModel\n     </strong>\n     introduces a couple of new methods, events and properties. It\'s important to know which are properties,\n\t\t\twhich are methods of an\tinstance, and which operate on the type itself.\n\t\t\tThese three categories are detailed below.\n    </p>\n    <p>\n     <strong>\n      Properties\n     </strong>\n     can be defined when extending Backbone.RelationalModel, or a subclass thereof.\n    </p>\n    <ul class="small">\n     <li>\n      <a href="#RelationalModel-relations">\n       relations\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-subModelTypes">\n       subModelTypes\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-subModelTypeAttribute">\n       subModelTypeAttribute\n      </a>\n     </li>\n    </ul>\n    <p>\n     <strong>\n      Instance methods\n     </strong>\n     operate on an instance of a type.\n    </p>\n    <ul class="small">\n     <li>\n      <a href="#RelationalModel-getAsync">\n       getAsync\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-getIdsToFetch">\n       getIdsToFetch\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-getRelation">\n       getRelation\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-getRelations">\n       getRelations\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-set">\n       set\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-toJSON">\n       toJSON\n      </a>\n     </li>\n    </ul>\n    <p>\n     <strong>\n      Static methods\n     </strong>\n     operate on the type itself, as opposed to operating on model instances.\n    </p>\n    <ul class="small">\n     <li>\n      <a href="#RelationalModel-setup">\n       setup\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-build">\n       build\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-findOrCreate">\n       findOrCreate\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-find">\n       find\n      </a>\n     </li>\n     <li>\n      <a href="#RelationalModel-findModel">\n       findModel\n      </a>\n     </li>\n    </ul>\n    <h3 id="RelationalModel-properties">\n     Properties\n    </h3>\n    <h4 class="code" id="RelationalModel-relations">\n     relations\n     <code>\n      relation[]\n     </code>\n    </h4>\n    <p>\n     A\n     <strong>\n      Backbone.RelationalModel\n     </strong>\n     may contain an array of relation definitions. Each relation supports a number of\n\t\t\toptions, of which\n     <a href="#relations-key">\n      <q>\n       key\n      </q>\n     </a>\n     and\n     <a href="#relations-type">\n      <q>\n       type\n      </q>\n     </a>\n     are mandatory.\n\t\t\tYou\'ll also need to specifiy\n     <a href="#relations-relatedModel">\n      <q>\n       relatedModel\n      </q>\n     </a>\n     if you want to reference another model.\n\t\t\tA relation could look like the following:\n    </p>\n    <pre class="language-javascript"><code class="runnable language-javascript" id="example-zoo">Zoo <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>RelationalModel<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\trelations<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>\n\t\ttype<span class="token punctuation">:</span> Backbone<span class="token punctuation">.</span>HasMany<span class="token punctuation">,</span>\n\t\tkey<span class="token punctuation">:</span> <span class="token string">\'animals\'</span><span class="token punctuation">,</span>\n\t\trelatedModel<span class="token punctuation">:</span> <span class="token string">\'Animal\'</span><span class="token punctuation">,</span>\n\t\tcollectionType<span class="token punctuation">:</span> <span class="token string">\'AnimalCollection\'</span><span class="token punctuation">,</span>\n\t\treverseRelation<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t\tkey<span class="token punctuation">:</span> <span class="token string">\'livesIn\'</span><span class="token punctuation">,</span>\n\t\t\tincludeInJSON<span class="token punctuation">:</span> <span class="token string">\'id\'</span>\n\t\t\t<span class="token comment" spellcheck="true">// \'relatedModel\' is automatically set to \'Zoo\'; the \'relationType\' to \'HasOne\'.\n</span>\t\t<span class="token punctuation">}</span>\n\t<span class="token punctuation">}</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nAnimal <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>RelationalModel<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\turlRoot<span class="token punctuation">:</span> <span class="token string">\'/animal/\'</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nAnimalCollection <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>Collection<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\tmodel<span class="token punctuation">:</span> Animal\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// We\'ve now created a fully managed relation. When you add or remove model from `zoo.animals`,\n</span><span class="token comment" spellcheck="true">// or update `animal.livesIn`, the other side of the relation will automatically be updated.\n</span><span class="token keyword">var</span> artis <span class="token operator">=</span> <span class="token keyword">new</span> Zoo<span class="token punctuation">(</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'Artis\'</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token keyword">var</span> lion <span class="token operator">=</span> <span class="token keyword">new</span> Animal<span class="token punctuation">(</span> <span class="token punctuation">{</span> species<span class="token punctuation">:</span> <span class="token string">\'Lion\'</span><span class="token punctuation">,</span> livesIn<span class="token punctuation">:</span> artis <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment" spellcheck="true">\n// `animals` in `artis` now contains `lion`\n</span>alert<span class="token punctuation">(</span> artis<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'animals\'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>pluck<span class="token punctuation">(</span> <span class="token string">\'species\'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n    <pre class="nomargin language-javascript"><code class="runnable language-javascript" data-setup="#example-zoo"><span class="token keyword">var</span> amersfoort <span class="token operator">=</span> <span class="token keyword">new</span> Zoo<span class="token punctuation">(</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'Dierenpark Amersfoort\'</span><span class="token punctuation">,</span> animals<span class="token punctuation">:</span> <span class="token punctuation">[</span> lion <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// `lion` now livesIn `amersfoort`, and `animals` in `artis` no longer contains `lion`\n</span>alert<span class="token punctuation">(</span> lion<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'livesIn\'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'name\'</span> <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">\', \'</span> <span class="token operator">+</span> artis<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'animals\'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n    <section id="relations-key">\n     <h4 class="code">\n      key\n      <code>\n       relation.key\n      </code>\n     </h4>\n     <p>\n      Required. A string that references an attribute name on\n      <a href="#relations-relatedModel">\n       <q>\n        relatedModel\n       </q>\n      </a>\n      .\n     </p>\n    </section>\n    <section id="relations-relatedModel">\n     <h4 class="code">\n      relatedModel\n      <code>\n       relation.relatedModel\n      </code>\n     </h4>\n     <p>\n      A string that can be resolved to an object on the global scope, or a reference to a\n      <strong>\n       Backbone.RelationalModel\n      </strong>\n      . Also see\n      <a href="#Store-addModelScope">\n       <q>\n        addModelScope\n       </q>\n      </a>\n      .\n     </p>\n     <p>\n      If omitted, the relation will be self-referential.\n     </p>\n    </section>\n    <section id="relations-type">\n     <h4 class="code">\n      type\n      <code>\n       relation.type\n      </code>\n     </h4>\n     <p>\n      Required. A string that references a\n      <a href="#Relation">\n       <q>\n        Backbone.Relation\n       </q>\n      </a>\n      type by name ("HasOne" or "HasMany"),\n\t\t\t\tor a direct reference to a relation type.\n     </p>\n     <p>\n      You can model a one-to-one or a many-to-one relationship by declaring\n      <q>\n       type\n      </q>\n      as the string "HasOne", or by\n\t\t\t\tdirectly referencing\n      <a href="#Relation-HasOne">\n       <q>\n        Backbone.HasOne\n       </q>\n      </a>\n      . A HasOne relation contains a single\n      <strong>\n       Backbone.RelationalModel\n      </strong>\n      . The default\n      <q>\n       reverseRelation.type\n      </q>\n      for a "HasOne" relation is\n\t\t\t\t"HasMany". This can be set to "HasOne" instead, to create a one-to-one relation.\n     </p>\n     <p>\n      You can model a one-to-many relationship by declaring\n      <q>\n       type\n      </q>\n      as the string "HasMany", or by directly\n\t\t\t\treferencing\n      <a href="#Relation-HasMany">\n       <q>\n        Backbone.HasMany\n       </q>\n      </a>\n      . A HasMany relation contains a Backbone.Collection,\n\t\t\t\tcontaining zero or more\n      <strong>\n       Backbone.RelationalModel\n      </strong>\n      s. The default\n      <q>\n       reverseRelation.type\n      </q>\n      for a HasMany relation is HasOne; this is the only option here, since many-to-many is not supported directly.\n     </p>\n     <p>\n      It is possible to model a many-to-many relationship using two\n      <a href="#Relation-HasMany">\n       <q>\n        Backbone.HasMany\n       </q>\n      </a>\n      relations, with a link model in between:\n     </p>\n    </section>\n    <pre class="language-javascript"><code class="language-javascript" id="example-job">Person <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>RelationalModel<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\trelations<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>\n\t\ttype<span class="token punctuation">:</span> <span class="token string">\'HasMany\'</span><span class="token punctuation">,</span>\n\t\tkey<span class="token punctuation">:</span> <span class="token string">\'jobs\'</span><span class="token punctuation">,</span>\n\t\trelatedModel<span class="token punctuation">:</span> <span class="token string">\'Job\'</span><span class="token punctuation">,</span>\n\t\treverseRelation<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t\tkey<span class="token punctuation">:</span> <span class="token string">\'person\'</span>\n\t\t<span class="token punctuation">}</span>\n\t<span class="token punctuation">}</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// A link object between \'Person\' and \'Company\'\n</span>Job <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>RelationalModel<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\tdefaults<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t<span class="token string">\'startDate\'</span><span class="token punctuation">:</span> <span class="token keyword">null</span><span class="token punctuation">,</span>\n\t\t<span class="token string">\'endDate\'</span><span class="token punctuation">:</span> <span class="token keyword">null</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nCompany <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>RelationalModel<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\trelations<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>\n\t\ttype<span class="token punctuation">:</span> <span class="token string">\'HasMany\'</span><span class="token punctuation">,</span>\n\t\tkey<span class="token punctuation">:</span> <span class="token string">\'employees\'</span><span class="token punctuation">,</span>\n\t\trelatedModel<span class="token punctuation">:</span> <span class="token string">\'Job\'</span><span class="token punctuation">,</span>\n\t\treverseRelation<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t\tkey<span class="token punctuation">:</span> <span class="token string">\'company\'</span>\n\t\t<span class="token punctuation">}</span>\n\t<span class="token punctuation">}</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n    <section id="relations-includeInJSON">\n     <h4 class="code">\n      includeInJSON\n      <code>\n       relation.includeInJSON\n      </code>\n     </h4>\n     <p>\n      A boolean, a string referencing one of the model\'s attributes, or an array of strings referencing model\n\t\t\t\tattributes. Default:\n      <q>\n       true\n      </q>\n      .\n     </p>\n     <p>\n      Determines how the contents of a relation will be serialized following a call to the\n      <a href="#RelationalModel-toJSON">\n       <q>\n        toJSON\n       </q>\n      </a>\n      method. If you specify a:\n     </p>\n     <ul>\n      <li>\n       <strong>\n        Boolean\n       </strong>\n       : a value of true serializes the full set of attributes on the related model(s).\n\t\t\t\t\tSet to false to\texclude the relation completely.\n      </li>\n      <li>\n       <strong>\n        String\n       </strong>\n       : include a single attribute from the related model(s). For example, \'name\', or\n       <q>\n        Backbone.Model.prototype.idAttribute\n       </q>\n       to include ids.\n      </li>\n      <li>\n       <strong>\n        String[]\n       </strong>\n       : includes the specified attributes from the related model(s).\n      </li>\n     </ul>\n     <p>\n      Specifying\n      <q>\n       true\n      </q>\n      will cascade, meaning the relations of nested model will get serialized as well,\n\t\t\t\tuntil either a different value is found for\n      <q>\n       includeInJSON\n      </q>\n      or we encounter a model that has already\n\t\t\t\tbeen serialized.\n     </p>\n    </section>\n    <section id="relations-autoFetch">\n     <h4 class="code">\n      autoFetch\n      <code>\n       relation.autoFetch\n      </code>\n     </h4>\n     <p>\n      A boolean or an object. Default:\n      <q>\n       false\n      </q>\n      .\n     </p>\n     <p>\n      If this property is set to\n      <q>\n       true\n      </q>\n      , when a model is instantiated the related model is\n\t\t\t\tautomatically fetched using\n      <a href="#RelationalModel-getAsync">\n       <q>\n        getAsync\n       </q>\n      </a>\n      . The\n\t\t\t\tvalue of the property can also be an object. In that case the object is passed to\n      <a href="#RelationalModel-getAsync">\n       <q>\n        getAsync\n       </q>\n      </a>\n      as the options parameter.\n     </p>\n     <p>\n      Note that\n      <q>\n       autoFetch\n      </q>\n      operates independently from other `fetch` operations,\n\t\t\t\tincluding those that may have fetched the current model.\n     </p>\n    </section>\n    <pre class="language-javascript"><code class="language-javascript"><span class="token keyword">var</span> Shop <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>RelationalModel<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\trelations<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n\t\t<span class="token punctuation">{</span>\n\t\t\ttype<span class="token punctuation">:</span> Backbone<span class="token punctuation">.</span>HasMany<span class="token punctuation">,</span>\n\t\t\tkey<span class="token punctuation">:</span> <span class="token string">\'customers\'</span><span class="token punctuation">,</span>\n\t\t\trelatedModel<span class="token punctuation">:</span> <span class="token string">\'Customer\'</span><span class="token punctuation">,</span>\n\t\t\tautoFetch<span class="token punctuation">:</span> <span class="token boolean">true</span>\n\t\t<span class="token punctuation">}</span><span class="token punctuation">,</span>\n\t\t<span class="token punctuation">{</span>\n\t\t\ttype<span class="token punctuation">:</span> Backbone<span class="token punctuation">.</span>HasOne<span class="token punctuation">,</span>\n\t\t\tkey<span class="token punctuation">:</span> <span class="token string">\'address\'</span><span class="token punctuation">,</span>\n\t\t\trelatedModel<span class="token punctuation">:</span> <span class="token string">\'Address\'</span><span class="token punctuation">,</span>\n\t\t\tautoFetch<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t\t\tsuccess<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> model<span class="token punctuation">,</span> response <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t\t\t\t<span class="token comment" spellcheck="true">//...\n</span>\t\t\t\t<span class="token punctuation">}</span><span class="token punctuation">,</span>\n\t\t\t\terror<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> model<span class="token punctuation">,</span> response <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t\t\t\t<span class="token comment" spellcheck="true">//...\n</span>\t\t\t\t<span class="token punctuation">}</span>\n\t\t\t<span class="token punctuation">}</span>\n\t\t<span class="token punctuation">}</span>\n\t<span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n    <section id="relations-collectionType">\n     <h4 class="code">\n      collectionType\n      <code>\n       relation.collectionType\n      </code>\n     </h4>\n     <p>\n      A string that can be resolved to an object type on the global scope, or a reference to a\n      <strong>\n       Backbone.Collection\n      </strong>\n      type.\n     </p>\n     <p>\n      Determine the type of collections used for a HasMany relation. If you define a\n\t\t\t\turl(models&lt;Backbone.Model[]&gt;) function on the specified collection, this enables\n      <a href="#RelationalModel-getAsync">\n       <q>\n        getAsync\n       </q>\n      </a>\n      to fetch all missing models in one request,\n\t\t\t\tinstead of firing a separate request for each.\n     </p>\n     <h4 class="code" id="relations-collectionKey">\n      collectionKey\n      <code>\n       relation.collectionKey\n      </code>\n     </h4>\n     <p>\n      A string or a boolean. Default:\n      <q>\n       true\n      </q>\n      .\n     </p>\n     <p>\n      Used to create a back reference from the\n      <strong>\n       Backbone.Collection\n      </strong>\n      used for a HasMany relation to the model on\n\t\t\t\tthe other side of this relation. By default, the relation\'s key attribute will be used to create a reference to\n\t\t\t\tthe RelationalModel instance from the generated collection. If you set\n      <q>\n       collectionKey\n      </q>\n      to a string,\n\t\t\t\tit will use that string as the reference to the RelationalModel, rather than the\n\t\t\t\trelation\'s key attribute. If you don\'t want this behavior at all, set\n      <q>\n       collectionKey\n      </q>\n      to\n      <q>\n       false\n      </q>\n      (or any falsy value) and this reference will not be created.\n     </p>\n    </section>\n    <section id="relations-collectionOptions">\n     <h4 class="code">\n      collectionOptions\n      <code>\n       relation.collectionOptions\n      </code>\n     </h4>\n     <p>\n      An options hash, or a function that accepts an instance of a\n      <strong>\n       Backbone.RelationalModel\n      </strong>\n      and returns an options\n\t\t\t\thash.\n     </p>\n     <p>\n      Used to provide options for the initialization of the collection in the \'Many\'-end of a HasMany relation. Can be\n\t\t\t\tan options hash or a function that should take the instance in the \'One\'-end of the \'HasMany\' relation and return\n\t\t\t\tan options hash.\n     </p>\n    </section>\n    <section id="relations-createModels">\n     <h4 class="code">\n      createModels\n      <code>\n       relation.createModels\n      </code>\n     </h4>\n     <p>\n      A boolean. Default:\n      <q>\n       true\n      </q>\n      .\n     </p>\n     <p>\n      Specifies whether models will be created from nested objects or not.\n     </p>\n    </section>\n    <section id="relations-keySource">\n     <h4 class="code">\n      keySource\n      <code>\n       relation.keySource\n      </code>\n     </h4>\n     <p>\n      A string that references an attribute to deserialize data for\n      <a href="#relations-relatedModel">\n       <q>\n        relatedModel\n       </q>\n      </a>\n      from.\n     </p>\n     <p>\n      Used to override key when determining what data to use when (de)serializing a relation, since the data backing\n\t\t\t\tyour relations may use different naming conventions. For example, a Rails backend may provide the keys suffixed\n\t\t\t\twith\n      <q>\n       _id\n      </q>\n      or\n      <q>\n       _ids\n      </q>\n      . The behavior for\n      <q>\n       keySource\n      </q>\n      corresponds to the following rules:\n     </p>\n     <p>\n      When a relation is instantiated, the contents of the\n      <q>\n       keySource\n      </q>\n      are used as its initial data. The\n\t\t\t\tapplication uses the regular key attribute to interface with the relation and the models in it; the\n      <q>\n       keySource\n      </q>\n      is not available as an attribute for the model. So you\tmay be provided with data containing\n      <q>\n       animal_ids\n      </q>\n      , while you want to access this relation as\n      <q>\n       zoo.get(\'animals\')\n      </q>\n      .\n     </p>\n     <p class="warning">\n      Note that setting\n      <q>\n       keySource\n      </q>\n      will set\n      <a href="#relations-keyDestination">\n       <q>\n        keyDestination\n       </q>\n      </a>\n      to the same value, if it isn\'t specified itself.\n\t\t\t\tThis means that when saving zoo, the animals attribute will be serialized back into the\n      <q>\n       animal_ids\n      </q>\n      key.\n     </p>\n     <p class="warning">\n      WARNING: when using a keySource, you should not use that attribute name for\tother purposes.\n     </p>\n    </section>\n    <section id="relations-keyDestination">\n     <h4 class="code">\n      keyDestination\n      <code>\n       relation.keyDestination\n      </code>\n     </h4>\n     <p>\n      A string that references an attribute to serialize\n      <a href="#relations-relatedModel">\n       <q>\n        relatedModel\n       </q>\n      </a>\n      into.\n     </p>\n     <p>\n      Used to override key (and\n      <a href="#relations-keySource">\n       <q>\n        keySource\n       </q>\n      </a>\n      ) when determining what attribute to be\n\t\t\t\twritten into when serializing a relation, since the server backing your relations may use different naming\n\t\t\t\tconventions. For example, a Rails backend may expect the keys to be suffixed with _attributes for nested\n\t\t\t\tattributes.\n     </p>\n     <p>\n      When calling\n      <a href="#RelationalModel-toJSON">\n       <q>\n        toJSON\n       </q>\n      </a>\n      on a model (either via\n      <strong>\n       Backbone.Sync\n      </strong>\n      , or directly), the data in the key attribute is transformed and assigned to the\n      <q>\n       keyDestination\n      </q>\n      .\n     </p>\n     <p>\n      So you may want a relation to be serialized into the animals_attributes key, while you want to access this\n\t\t\t\trelation as\n      <q>\n       zoo.get( \'animals\' );\n      </q>\n      .\n     </p>\n     <p class="warning">\n      WARNING: when using a\n      <q>\n       keyDestination\n      </q>\n      , you should not use that attribute name for other purposes.\n     </p>\n    </section>\n    <pre class="language-javascript"><code class="runnable language-javascript" data-setup="#example-zoo"><span class="token keyword">var</span> FarmAnimal <span class="token operator">=</span> Animal<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// This `Farm` is confused, like legacy stuff can be. It wants its data back on a completely\n</span><span class="token comment" spellcheck="true">// different key than it supplies it on. We want to use a different one in our app as well.\n</span><span class="token keyword">var</span> Farm <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>RelationalModel<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\trelations<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token punctuation">{</span>\n\t\ttype<span class="token punctuation">:</span> Backbone<span class="token punctuation">.</span>HasMany<span class="token punctuation">,</span>\n\t\tkey<span class="token punctuation">:</span> <span class="token string">\'animals\'</span><span class="token punctuation">,</span>\n\t\tkeySource<span class="token punctuation">:</span> <span class="token string">\'livestock\'</span><span class="token punctuation">,</span>\n\t\tkeyDestination<span class="token punctuation">:</span> <span class="token string">\'pets\'</span><span class="token punctuation">,</span>\n\t\trelatedModel<span class="token punctuation">:</span> FarmAnimal<span class="token punctuation">,</span>\n\t\treverseRelation<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t\tkey<span class="token punctuation">:</span> <span class="token string">\'farm\'</span><span class="token punctuation">,</span>\n\t\t\tincludeInJSON<span class="token punctuation">:</span> <span class="token string">\'name\'</span>\n\t\t<span class="token punctuation">}</span>\n\t<span class="token punctuation">}</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment" spellcheck="true">\n// Create a `Farm`; parse `species`, add to `animals`, output goes to `pets`.\n</span><span class="token keyword">var</span> farm <span class="token operator">=</span> <span class="token keyword">new</span> Farm<span class="token punctuation">(</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'Old MacDonald\'</span><span class="token punctuation">,</span> livestock<span class="token punctuation">:</span> <span class="token punctuation">[</span> <span class="token punctuation">{</span> species<span class="token punctuation">:</span> <span class="token string">\'Sheep\'</span> <span class="token punctuation">}</span> <span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\nfarm<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'animals\'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token number">add</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> species<span class="token punctuation">:</span> <span class="token string">\'Cow\'</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\nalert<span class="token punctuation">(</span> JSON<span class="token punctuation">.</span>stringify<span class="token punctuation">(</span> farm<span class="token punctuation">.</span>toJSON<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n    <section id="relations-parse">\n     <h4 class="code">\n      parse\n      <code>\n       relation.parse\n      </code>\n     </h4>\n     <p>\n      A boolean. Default:\n      <q>\n       false\n      </q>\n      .\n     </p>\n     <p>\n      If you have a relation where the models should be parsed when data is being set, specify `parse: true`.\n     </p>\n    </section>\n    <section id="relations-reverseRelation">\n     <h4 class="code">\n      reverseRelation\n      <code>\n       relation.reverseRelation\n      </code>\n     </h4>\n     <p>\n      An object specifying the relation pointing back to this model from\n      <a href="#relations-relatedModel">\n       <q>\n        relatedModel\n       </q>\n      </a>\n      .\n     </p>\n     <p>\n      If the relation should be bidirectional, specify the details for the reverse relation here. It\'s only mandatory\n\t\t\t\tto supply a\n      <a href="#relations-key">\n       <q>\n        key\n       </q>\n      </a>\n      ;\n      <a href="#relations-relatedModel">\n       <q>\n        relatedModel\n       </q>\n      </a>\n      is automatically\n\t\t\t\tset. The default\n      <a href="#relations-type">\n       <q>\n        type\n       </q>\n      </a>\n      for a\n      <q>\n       reverseRelation\n      </q>\n      is HasMany for a\n\t\t\t\tHasOne relation (which can be overridden to HasOne in order to create a one-to-one relation), and HasOne for a\n\t\t\t\tHasMany relation. In this case, you cannot create a\n      <q>\n       reverseRelation\n      </q>\n      with\n\t\t\t\ttype HasMany as well; please see Many-to-many relations on how to model these type of relations.\n     </p>\n     <p class="warning">\n      Note that if you define a relation (plus a reverseRelation) on a model,\tbut don\'t actually create an instance\n\t\t\t\tof that model, it is possible\n      <q>\n       initializeRelations\n      </q>\n      will never get\tcalled, and the reverseRelation\n\t\t\t\twill not be initialized. This can happen when\n      <q>\n       extend\n      </q>\n      has been overridden, or redefined as in CoffeeScript.\n\t\t\t\tSee\n      <a href="#RelationalModel-setup">\n       setup\n      </a>\n      .\n     </p>\n    </section>\n    <section id="RelationalModel-subModelTypes">\n     <h4 class="code">\n      subModelTypes\n      <code>\n       relationalModel.subModelTypes(attributes&lt;object&gt;, [options&lt;object&gt;])\n      </code>\n     </h4>\n     <p>\n      An object. Default:\n      <q>\n       {}\n      </q>\n      .\n     </p>\n     <p>\n      A mapping that defines what submodels exist for the model (the superModel) on which\n      <q>\n       subModelTypes\n      </q>\n      is defined. The keys are used to match the\n      <a href="#RelationalModel-subModelTypeAttribute">\n       <q>\n        subModelTypeAttribute\n       </q>\n      </a>\n      when deserializing, and the values\n\t\t\t\tdetermine what type of submodel should be created for a key. When building model instances from data, we need to\n\t\t\t\tdetermine what kind of object we\'re dealing with in order to create instances of the right subModel type. This\n\t\t\t\tis done by finding the model for which the key is equal to the value of the\n      <a href="#RelationalModel-subModelTypeAttribute">\n       <q>\n        subModelTypeAttribute\n       </q>\n      </a>\n      attribute on the passed in data.\n     </p>\n     <p>\n      Each subModel is considered to be a proper submodel of its superclass (the model type you\'re extending), with a\n\t\t\t\tshared id pool. This means that when looking for an object of the supermodel\'s type, objects of a submodel\'s type\n\t\t\t\tcan be returned as well, as long as the id matches. In effect, any relations pointing to the supermodel will look\n\t\t\t\tfor instances of its submodels as well.\n     </p>\n     <pre class="language-javascript"><code class="runnable language-javascript" data-setup="#example-zoo">Mammal <span class="token operator">=</span> Animal<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\tsubModelTypes<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t<span class="token string">\'primate\'</span><span class="token punctuation">:</span> <span class="token string">\'Primate\'</span><span class="token punctuation">,</span>\n\t\t<span class="token string">\'carnivore\'</span><span class="token punctuation">:</span> <span class="token string">\'Carnivore\'</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nPrimate <span class="token operator">=</span> Mammal<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\nCarnivore <span class="token operator">=</span> Mammal<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nMammalCollection <span class="token operator">=</span> AnimalCollection<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\tmodel<span class="token punctuation">:</span> Mammal\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// Create a collection that contains a \'Primate\' and a \'Carnivore\'.\n</span><span class="token keyword">var</span> mammals <span class="token operator">=</span> <span class="token keyword">new</span> MammalCollection<span class="token punctuation">(</span><span class="token punctuation">[</span>\n\t<span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> species<span class="token punctuation">:</span> <span class="token string">\'chimp\'</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">\'primate\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\t<span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">5</span><span class="token punctuation">,</span> species<span class="token punctuation">:</span> <span class="token string">\'panther\'</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">\'carnivore\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">var</span> chimp <span class="token operator">=</span> mammals<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token number">3</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nalert<span class="token punctuation">(</span> <span class="token string">\'chimp is an animal? \'</span> <span class="token operator">+</span> <span class="token punctuation">(</span> chimp <span class="token keyword">instanceof</span> Animal <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">\'\\n\'</span> <span class="token operator">+</span>\n\t<span class="token string">\'chimp is a carnivore? \'</span> <span class="token operator">+</span> <span class="token punctuation">(</span> chimp <span class="token keyword">instanceof</span> Carnivore <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">\'\\n\'</span> <span class="token operator">+</span>\n\t<span class="token string">\'chimp is a primate? \'</span> <span class="token operator">+</span> <span class="token punctuation">(</span> chimp <span class="token keyword">instanceof</span> Primate <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n     <p>\n      Suppose that we have an Mammal model and a Primate model extending Mammal. If we have a Primate object with id 3,\n\t\t\t\tthis object will be returned when we have a relation pointing to a Mammal with id 3, as Primate is regarded a\n\t\t\t\tspecific kind of Mammal; it\'s just a Mammal with possibly some primate-specific properties or methods.\n     </p>\n     <p class="warning">\n      Note that this means that there cannot be any overlap in ids between instances of Mammal and Primate, as the\n\t\t\t\tPrimate with id 3 will be the Mammal with id 3.\n     </p>\n    </section>\n    <section id="RelationalModel-subModelTypeAttribute">\n     <h4 class="code">\n      subModelTypeAttribute\n      <code>\n       relationalModel.subModelTypeAttribute\n      </code>\n     </h4>\n     <p>\n      A string. Default:\n      <q>\n       type\n      </q>\n      .\n     </p>\n     <p>\n      The\n      <q>\n       subModelTypeAttribute\n      </q>\n      references an attribute on the data\n\t\t\t\tused to instantiate\n      <a href="#relations-relatedModel">\n       <q>\n        relatedModel\n       </q>\n      </a>\n      . The attribute that will be checked to\n\t\t\t\tdetermine the type of model that should be built when a raw object of attributes is set as the related value,\n\t\t\t\tand if the\n      <a href="#relations-relatedModel">\n       <q>\n        relatedModel\n       </q>\n      </a>\n      has one or more submodels.\n     </p>\n    </section>\n    <h3 id="RelationalModel-instance-methods">\n     Instance methods\n    </h3>\n    <section id="RelationalModel-getAsync">\n     <h4 class="code">\n      getAsync\n      <code>\n       relationalModel.getAsync(attr&lt;string&gt;, [options&lt;object&gt;]\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       jQuery.Deferred\n      </q>\n      A\n      <a href="http://api.jquery.com/category/deferred-object/">\n       jQuery promise\n      </a>\n     </p>\n     <p>\n      Get an attribute\'s value asynchronously. If available, the local value will be returned.\n\t\t\t\tIf\n      <q>\n       attr\n      </q>\n      is a relation and one or more of its models are not available, they will be fetched.\n     </p>\n     <p>\n      This can be used specifically for lazy-loading scenarios.\n\t\t\t\tOnly models are referenced in the attributes but have not been found/created yet are fetched.\n\t\t\t\tSetting\n      <q>\n       options.refresh\n      </q>\n      to true will fetch all model(s) from the server.\n\t\t\t\tIn that case, any model that already exists will be updated with the retrieved data.\n\t\t\t\tThe\n      <q>\n       options\n      </q>\n      object specifies options to be passed to\n      <a href="http://backbonejs.org/#Sync">\n       Backbone.Sync\n      </a>\n      .\n     </p>\n     <p>\n      By default, a separate request will be fired for each model that is to be fetched from the server (if `key` references a collection).\n\t\t\t\tHowever, if your server/API supports it, you can fetch the set of models in one request by specifying a\n\t\t\t\tcollectionType for the relation you call getAsync on. The\n      <a href="#relations-collectionType">\n       <q>\n        collectionType\n       </q>\n      </a>\n      should have an overridden\n      <a href="http://backbonejs.org/#Collection-url">\n       <q>\n        url\n       </q>\n      </a>\n      method that allows it to construct a url for an array of models. See\n      <a href="#example-person">\n       this example\n      </a>\n      or\n      <a href="https://github.com/PaulUithol/backbone-tastypie">\n       Backbone-tastypie\n      </a>\n      for an example.\n     </p>\n    </section>\n    <section id="RelationalModel-getIdsToFetch">\n     <h4 class="code">\n      getIdsToFetch\n      <code>\n       relationModel.getIdsToFetch(attr&lt;string|Backbone.Relation&gt;, [refresh&lt;boolean&gt;])\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       Array\n      </q>\n      A list of the ids that will be fetched when calling\n      <q>\n       getAsync\n      </q>\n      .\n     </p>\n    </section>\n    <section id="RelationalModel-getRelation">\n     <h4 class="code">\n      getRelation\n      <code>\n       relationModel.getRelation(attr&lt;string&gt;)\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       Backbone.Relation\n      </q>\n      A single initialized relation on the model.\n     </p>\n    </section>\n    <section id="RelationalModel-getRelations">\n     <h4 class="code">\n      getRelations\n      <code>\n       relationModel.getRelations()\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       Backbone.Relation[]\n      </q>\n      The set of initialized relations on the model.\n     </p>\n    </section>\n    <section id="RelationalModel-set">\n     <h4 class="code">\n      set\n      <code>\n       set(key&lt;string&gt;, value, [options&lt;object&gt;])\n       <strong>\n        or\n       </strong>\n       set(attributes&lt;object&gt;, [options&lt;object&gt;])\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       Backbone.RelationalModel\n      </q>\n      The model instance.\n     </p>\n     <p>\n      The\n      <q>\n       set\n      </q>\n      method is overridden so that setting a value on an "relational" attribute will update that relation.\n\t\t\t\tThis is especially important to keep in mind for\n      <q>\n       HasMany\n      </q>\n      relations (which are backed by a\n      <q>\n       Backbone.Collection\n      </q>\n      ).\n\t\t\t\tFor these, calling\n      <q>\n       set\n      </q>\n      can be thought of as being equivalent to calling\n      <q>\n       update\n      </q>\n      on the collection itself,\n\t\t\t\tincluding how the options are handled.\n     </p>\n     <p>\n      Additional\n      <q>\n       options\n      </q>\n      for a\n      <q>\n       HasMany\n      </q>\n      relation:\n     </p>\n     <dl>\n      <dt>\n       <q>\n        add\n       </q>\n      </dt>\n      <dd>\n       Default:\n       <q>\n        true\n       </q>\n       . If true, models specified in the arguments but not yet present in the relation will be added to the relation.\n      </dd>\n      <dt>\n       <q>\n        merge\n       </q>\n      </dt>\n      <dd>\n       Default:\n       <q>\n        true\n       </q>\n       . If true, existing models will be updated with the given attributes.\n      </dd>\n      <dt>\n       <q>\n        remove\n       </q>\n      </dt>\n      <dd>\n       Default:\n       <q>\n        true\n       </q>\n       . If true, models present in the relation but not specified in the arguments will be removed.\n      </dd>\n     </dl>\n    </section>\n    <section id="RelationalModel-toJSON">\n     <h4 class="code">\n      toJSON\n      <code>\n       relationModel.toJSON(name&lt;string&gt;)\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       Object\n      </q>\n      The JSON representation of the model.\n\t\t\t\tSee\n      <a href="http://backbonejs.org/#Model-toJSON">\n       Backbone.Model.toJSON\n      </a>\n      .\n     </p>\n     <p>\n      The regular\n      <q>\n       toJSON\n      </q>\n      function has been overridden and modified to serialize (nested) relations\n\t\t\t\taccording to their\n      <a href="#relations-includeInJSON">\n       <q>\n        includeInJSON\n       </q>\n      </a>\n      ,\n      <a href="#relations-keySource">\n       <q>\n        keySource\n       </q>\n      </a>\n      ,\n\t\t\t\tand\n      <a href="#relations-keyDestination">\n       <q>\n        keyDestination\n       </q>\n      </a>\n      options.\n     </p>\n    </section>\n    <h3 id="RelationalModel-static-methods">\n     Static methods\n    </h3>\n    <section id="RelationalModel-setup">\n     <h4 class="code">\n      setup\n      <code>\n       relationModel.setup()\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       Backbone.RelationalModel.constuctor\n      </q>\n      The type.\n     </p>\n     <p>\n      Initialize the relations and submodels for the model type. Normally, this happens automatically, but it doesn\'t if\n\t\t\t\tyou\'re using CoffeeScript and using the syntax\n      <q>\n       class MyModel extends Backbone.RelationalModel\n      </q>\n      instead of\n\t\t\t\tthe JavaScript equivalent of\n      <q>\n       MyModel = Backbone.RelationalModel.extend()\n      </q>\n      .\n     </p>\n     <p>\n      This has advantages in CoffeeScript, but it also means that\n      <q>\n       Backbone.Model.extend\n      </q>\n      will not get called.\n\t\t\t\tInstead, CoffeeScript generates piece of code that would normally achieve the same.\tHowever,\n      <q>\n       extend\n      </q>\n      is also\n\t\t\t\tthe method that Backbone-relational overrides to set up relations as you\'re defining your\n      <q>\n       Backbone.RelationalModel\n      </q>\n      subclass.\n     </p>\n     <p>\n      In this case, you should call\n      <q>\n       setup\n      </q>\n      manually after defining your subclass CoffeeScript-style. For example:\n     </p>\n     <p class="warning">\n      Note: this is a static method. It operates on the model type itself, not on an instance of it.\n     </p>\n    </section>\n    <pre class="language-javascript"><code class="language-javascript">class Animal extends Backbone<span class="token punctuation">.</span>RelationalModel\n    urlRoot<span class="token punctuation">:</span> <span class="token string">"/animal"</span>\n\nclass Mammal extends Animal\n    subModelTypes<span class="token punctuation">:</span>\n        <span class="token string">"primate"</span><span class="token punctuation">:</span> <span class="token string">"Primate"</span>\n        <span class="token string">"carnivore"</span><span class="token punctuation">:</span> <span class="token string">"Carnivore"</span>\n\n    relations<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n        # More relations\n    <span class="token punctuation">]</span>\n\nMammal<span class="token punctuation">.</span>setup<span class="token punctuation">(</span><span class="token punctuation">)</span>\n\nclass Primate extends Mammal\n\nclass Carnivore extends Mammal\n\nchimp <span class="token operator">=</span> Mammal<span class="token punctuation">.</span>build<span class="token punctuation">(</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">3</span><span class="token punctuation">,</span> species<span class="token punctuation">:</span> <span class="token string">"chimp"</span><span class="token punctuation">,</span> type<span class="token punctuation">:</span> <span class="token string">"primate"</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span>\n</code></pre>\n    <section id="RelationalModel-build">\n     <h4 class="code">\n      build\n      <code>\n       relationalModel.build(attributes&lt;object&gt;, [options&lt;object&gt;])\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       Backbone.RelationalModel\n      </q>\n      A model instance.\n     </p>\n     <p>\n      Create an instance of a model, taking into account what submodels have been defined.\n     </p>\n     <p class="warning">\n      Note: this is a static method. It operates on the model type itself, not on an instance.\n     </p>\n    </section>\n    <section id="RelationalModel-findOrCreate">\n     <h4 class="code">\n      findOrCreate\n      <code>\n       relationalModel.findOrCreate(attributes&lt;string|number|object&gt;, [options&lt;object&gt;])\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       Backbone.RelationalModel\n      </q>\n      A model instance.\n     </p>\n     <p>\n      Search for a model instance in the\n      <a href="#Store">\n       Backbone.Relational.store\n      </a>\n      , and return the model if found.\n\t\t\t\tA new model will be created if no model is found,\n      <q>\n       attributes\n      </q>\n      is an object, and\n      <q>\n       options.create\n      </q>\n      is\n      <q>\n       true\n      </q>\n      .\n     </p>\n     <p>\n      Accepted\n      <q>\n       options\n      </q>\n      :\n     </p>\n     <dl>\n      <dt>\n       <q>\n        create\n       </q>\n      </dt>\n      <dd>\n       Default:\n       <q>\n        true\n       </q>\n       . If true, a new model will be created if an instance matching\n       <q>\n        attributes\n       </q>\n       isn\'t found in the store.\n      </dd>\n      <dt>\n       <q>\n        merge\n       </q>\n      </dt>\n      <dd>\n       Default:\n       <q>\n        true\n       </q>\n       . If true, a found model will be updated with\n       <q>\n        attributes\n       </q>\n       (if\n       <q>\n        attributes\n       </q>\n       is an\n       <q>\n        object\n       </q>\n       ).\n      </dd>\n      <dt>\n       <q>\n        parse\n       </q>\n      </dt>\n      <dd>\n       Default:\n       <q>\n        false\n       </q>\n       . If true,\n       <q>\n        attributes\n       </q>\n       will be parsed first. Please note this will cause\n       <q>\n        Model.parse\n       </q>\n       to be called\n\t\t\t\tas a function (\n       <q>\n        this\n       </q>\n       will not point to a model), instead of as a method.\n      </dd>\n     </dl>\n     <p class="warning">\n      Note: this is a static method. It operates on the model type itself, not on an instance of it.\n     </p>\n    </section>\n    <section id="RelationalModel-find">\n     <h4 class="code">\n      find\n      <code>\n       relationalModel.find(attributes&lt;string|number|object&gt;, [options&lt;object&gt;])\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       Backbone.RelationalModel\n      </q>\n      A model instance.\n     </p>\n     <p>\n      A shortcut for\n      <a href="#RelationalModel-findOrCreate">\n       <q>\n        findOrCreate\n       </q>\n      </a>\n      that uses\n      <q>\n       create: false\n      </q>\n      .\n\t\t\t\tAccepts the same options as\n      <q>\n       findOrCreate\n      </q>\n      (except for\n      <q>\n       create\n      </q>\n      ).\n     </p>\n     <p class="warning">\n      Note: this is a static method. It operates on the model type itself, not on an instance of it.\n     </p>\n    </section>\n    <section id="RelationalModel-findModel">\n     <h4 class="code">\n      findModel\n      <code>\n       relationalModel.findModel(attributes&lt;string|number|object&gt;)\n      </code>\n     </h4>\n     <p>\n      Returns:\n      <q>\n       Backbone.RelationalModel\n      </q>\n      A model instance.\n     </p>\n     <p>\n      A hook to override the matching when updating (or creating) a model.\n\t\t\t\tThe default implementation is to look up the model by id in the store:\n      <q>\n       return Backbone.Relational.store.find( this, attributes );\n      </q>\n     </p>\n     <p>\n      Custom behavior is useful in cases where (a collection of) nested data gets saved to the server.\n\t\t\t\tConsider saving the following model:\n     </p>\n     <pre class="language-javascript"><code class="runnable language-javascript" data-setup="#example-zoo"><span class="token keyword">var</span> zoo <span class="token operator">=</span> <span class="token keyword">new</span> Zoo<span class="token punctuation">(</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token number">1</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">\'Artis\'</span><span class="token punctuation">,</span> animals<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n\t<span class="token punctuation">{</span> species<span class="token punctuation">:</span> <span class="token string">\'Giraffe\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span>\n\t<span class="token punctuation">{</span> species<span class="token punctuation">:</span> <span class="token string">\'Camel\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">]</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nalert<span class="token punctuation">(</span> JSON<span class="token punctuation">.</span>stringify<span class="token punctuation">(</span> zoo<span class="token punctuation">.</span>toJSON<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token number">4</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n     <p>\n      Normally, whatever you use as server-side logic will respond by creating two animals, and assigning them\n\t\t\t\tan id. The response will be used by Backbone-relational to update existing models.\n\t\t\t\tHowever, updating a model starts by looking up the local model with the same id; and in this case,\n\t\t\t\tBackbone-relational does not know which local models corresponds to which created animal with an id.\n\t\t\t\tA simple fix in this case would be to add a fallback option for the matching by using the animal\'s\n\t\t\t\tspecies. Do note you\'d want to use a more robust method usually, such as using a new model\'s\n      <q>\n       cid\n      </q>\n      .\n     </p>\n     <pre class="language-javascript"><code class="runnable language-javascript" data-setup="#example-zoo">Zoo<span class="token punctuation">.</span>findModel <span class="token operator">=</span> <span class="token keyword">function</span><span class="token punctuation">(</span> attributes <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t<span class="token comment" spellcheck="true">// Try to find an instance of \'this\' model type in the store\n</span>\t<span class="token keyword">var</span> model <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>Relational<span class="token punctuation">.</span>store<span class="token punctuation">.</span>find<span class="token punctuation">(</span> this<span class="token punctuation">,</span> attributes <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token operator">!</span>model <span class="token operator">&amp;&amp;</span> _<span class="token punctuation">.</span>isObject<span class="token punctuation">(</span> attributes <span class="token punctuation">)</span> <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token keyword">var</span> coll <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>Relational<span class="token punctuation">.</span>store<span class="token punctuation">.</span>getCollection<span class="token punctuation">(</span> this <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n\t\tmodel <span class="token operator">=</span> coll<span class="token punctuation">.</span>find<span class="token punctuation">(</span> <span class="token keyword">function</span><span class="token punctuation">(</span> m <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t\t<span class="token keyword">return</span> m<span class="token punctuation">.</span>species <span class="token operator">==</span><span class="token operator">=</span> attributes<span class="token punctuation">.</span>species<span class="token punctuation">;</span>\n\t\t<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span>\n\n\t<span class="token keyword">return</span> model<span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span>\n</code></pre>\n     <p class="warning">\n      Note: this is a static method. It operates on the model type itself, not on an instance of it.\n     </p>\n    </section>\n    <section id="RelationalModel-events">\n     <h4>\n      Catalog of Events\n     </h4>\n     <p>\n      Backbone-relational makes a couple of additional events available to you, on top of\tthe events already found in Backbone.\n     </p>\n     <ul class="small">\n      <li>\n       An\n       <strong>\n        "add"\n       </strong>\n       event is triggered on addition to a HasMany relation. Bind to:\n       <br/>\n       <q>\n        add:&lt;key&gt;\n       </q>\n       \xe2\x86\x92\n       <code>\n        function(addedModel&lt;Backbone.Model&gt;, related&lt;Backbone.Collection&gt;)\n       </code>\n      </li>\n      <li>\n       A\n       <strong>\n        "remove"\n       </strong>\n       event is triggered on removal from a HasMany relation. Bind to:\n       <br/>\n       <q>\n        remove:&lt;key&gt;\n       </q>\n       \xe2\x86\x92\n       <code>\n        function(removedModel&lt;Backbone.Model&gt;, related&lt;Backbone.Collection&gt;)\n       </code>\n      </li>\n      <li>\n       A\n       <strong>\n        "change"\n       </strong>\n       event is triggered on changes to the contents of both HasOne and HasMany relations. Bind to:\n       <br/>\n       <q>\n        change:&lt;key&gt;\n       </q>\n       \xe2\x86\x92\n       <code>\n        function(model&lt;Backbone.Model&gt;, related&lt;Backbone.Model|Backbone.Collection&gt;)\n       </code>\n      </li>\n     </ul>\n    </section>\n   </section>\n   <section id="Relation">\n    <h2>\n     Backbone.Relation\n    </h2>\n    <p>\n     Each\n     <a href="#RelationalModel-relations">\n      relation\n     </a>\n     definition on a model is used to create in instance of a\n     <q>\n      Backbone.Relation\n     </q>\n     ; either\n\t\t\ta\n     <q>\n      Backbone.HasOne\n     </q>\n     or a\n     <q>\n      Backbone.HasMany\n     </q>\n     .\n    </p>\n    <h4 class="code" id="Relation-HasOne">\n     Backbone.HasOne\n    </h4>\n    <p>\n     Defines a\n     <strong>\n      HasOne\n     </strong>\n     relation. When defining a\n     <a href="#relations-reverseRelation">\n      reverseRelation\n     </a>\n     , the default type\n\t\t\twill be\n     <strong>\n      HasMany\n     </strong>\n     . However, this can also be set to\n     <strong>\n      HasOne\n     </strong>\n     to define a one-to-one relation.\n    </p>\n    <h4 class="code" id="Relation-HasMany">\n     Backbone.HasMany\n    </h4>\n    <p>\n     Defines a\n     <strong>\n      HasMany\n     </strong>\n     relation. When defining a\n     <a href="#relations-reverseRelation">\n      reverseRelation\n     </a>\n     , the type\n\t\t\twill be\n     <strong>\n      HasOne\n     </strong>\n     .\n    </p>\n   </section>\n   <section id="Store">\n    <h2>\n     Backbone.Store\n    </h2>\n    <p>\n     <strong>\n      Backbone.Store\n     </strong>\n     is a global model cache. Per application, one instance is created (much like\n     <q>\n      Backbone.History\n     </q>\n     ),\n\t\t\twhich is accessible as\n     <q>\n      Backbone.Relational.store\n     </q>\n     .\n    </p>\n    <h4 class="code" id="Store-addModelScope">\n     addModelScope\n     <code>\n      Backbone.Relational.store.addModelScope(scope&lt;object&gt;)\n     </code>\n    </h4>\n    <p>\n     Add a namespace on which models and collections are defined. This is especially useful when working in an\n\t\t\tenvironment without a shared global scope (like\n     <q>\n      window\n     </q>\n     is in a browser), where you\'ll need to tell\n\t\t\tthe\n     <q>\n      store\n     </q>\n     where your models are defined, so it can resolve them to create and maintain relations.\n    </p>\n    <h4 class="code" id="Store-removeModelScope">\n     removeModelScope\n     <code>\n      Backbone.Relational.store.removeModelScope()\n     </code>\n    </h4>\n    <p>\n     Remove a scope. This allows you to remove a scope you added previously, or to remove the default \'global\'\n\t\t\tscope (\n     <q>\n      window\n     </q>\n     in the browser) scope to prevent Backbone-relational from resolving objects on it.\n    </p>\n    <h4 class="code" id="Store-reset">\n     reset\n     <code>\n      Backbone.Relational.store.reset()\n     </code>\n    </h4>\n    <p>\n     Reset the\n     <q>\n      store\n     </q>\n     to its original state. This will disable relations for all models created up to this point,\n\t\t\tremove added model scopes, and removed all internal store collections.\n    </p>\n    <h4 class="code" id="Store-unregister">\n     unregister\n     <code>\n      Backbone.Relational.store.unregister(type&lt;Backbone.RelationalModel|Backbone.RelationalModel.constructor|Backbone.Collection&gt;)\n     </code>\n    </h4>\n    <p>\n     Unregister a single model or a collection. Unregistering a model will remove a model from any relations it\'s involved in.\n\t\t\tInternally, unregister is called when a model has been destroyed. It can also be called explicitly to on models\n\t\t\tyou don\'t want Backbone-relational to consider for relations anymore, for example to free up models used as (temporary) search results.\n    </p>\n   </section>\n   <section id="examples">\n    <h2>\n     Examples\n    </h2>\n    <p>\n     <a href="http://antoviaque.org/docs/tutorials/backbone-relational-tutorial/">\n      A tutorial by antoviaque\n     </a>\n     ,\n\t\t\tand the\n     <a href="https://github.com/antoviaque/backbone-relational-tutorial">\n      accompanying git repository\n     </a>\n     .\n    </p>\n    <p>\n     A basic working example to get you started:\n    </p>\n    <pre class="language-javascript"><code class="runnable language-javascript" data-setup="#example-person" id="example-person-run1"><span class="token keyword">var</span> paul <span class="token operator">=</span> <span class="token keyword">new</span> Person<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\tid<span class="token punctuation">:</span> <span class="token string">\'person-1\'</span><span class="token punctuation">,</span>\n\tname<span class="token punctuation">:</span> <span class="token string">\'Paul\'</span><span class="token punctuation">,</span>\n\tuser<span class="token punctuation">:</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token string">\'user-1\'</span><span class="token punctuation">,</span> login<span class="token punctuation">:</span> <span class="token string">\'dude\'</span><span class="token punctuation">,</span> email<span class="token punctuation">:</span> <span class="token string">\'me@gmail.com\'</span> <span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// A User object is automatically created from the JSON; so \'login\' returns \'dude\'.\n</span>paul<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'user\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'login\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token keyword">var</span> ourHouse <span class="token operator">=</span> <span class="token keyword">new</span> House<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\tid<span class="token punctuation">:</span> <span class="token string">\'house-1\'</span><span class="token punctuation">,</span>\n\tlocation<span class="token punctuation">:</span> <span class="token string">\'in the middle of the street\'</span><span class="token punctuation">,</span>\n\toccupants<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token string">\'person-1\'</span><span class="token punctuation">,</span> <span class="token string">\'person-2\'</span><span class="token punctuation">,</span> <span class="token string">\'person-5\'</span><span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\n<span class="token comment" spellcheck="true">// \'ourHouse.occupants\' is turned into a Backbone.Collection of Persons.\n</span><span class="token comment" spellcheck="true">// The first person in \'ourHouse.occupants\' will point to \'paul\'.\n</span>ourHouse<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'occupants\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>at<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // === paul\n</span><span class="token comment" spellcheck="true">\n// If a collection is created from a HasMany relation, it contains a reference\n</span><span class="token comment" spellcheck="true">// back to the originator of the relation\n</span>ourHouse<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'occupants\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>livesIn<span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // === ourHouse\n</span><span class="token comment" spellcheck="true">\n// The `occupants` relation on \'House\' has been defined as a HasMany, with a reverse relation\n</span><span class="token comment" spellcheck="true">// to `livesIn` on \'Person\'. So, \'paul.livesIn\' will automatically point back to \'ourHouse\'.\n</span>paul<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'livesIn\'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment" spellcheck="true"> // === ourHouse\n</span><span class="token comment" spellcheck="true">\n// You can control which relations get serialized to JSON, using the \'includeInJSON\'\n</span><span class="token comment" spellcheck="true">// property on a Relation. Also, each object will only get serialized once to prevent loops.\n</span>alert<span class="token punctuation">(</span> JSON<span class="token punctuation">.</span>stringify<span class="token punctuation">(</span> paul<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">\'user\'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>toJSON<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token string">\'\\t\'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n    <pre class="nomargin language-javascript"><code class="runnable language-javascript" data-setup="#example-person-run1" id="example-person-run2"><span class="token comment" spellcheck="true">// Load occupants \'person-2\' and \'person-5\', which don\'t exist yet, from the server\n</span>ourHouse<span class="token punctuation">.</span>getAsync<span class="token punctuation">(</span> <span class="token string">\'occupants\'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment" spellcheck="true">\n// Use the `add` and `remove` events to listen for additions/removals on a HasMany relation.\n</span><span class="token comment" spellcheck="true">// Here, we listen for changes to `ourHouse.occupants`.\n</span>ourHouse\n\t<span class="token punctuation">.</span>on<span class="token punctuation">(</span> <span class="token string">\'add:occupants\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> model<span class="token punctuation">,</span> coll <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\tconsole<span class="token punctuation">.</span>log<span class="token punctuation">(</span> <span class="token string">\'add %o\'</span><span class="token punctuation">,</span> model <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\t<span class="token comment" spellcheck="true">\t// Do something. Create a View?\n</span>\t<span class="token punctuation">}</span><span class="token punctuation">)</span>\n\t<span class="token punctuation">.</span>on<span class="token punctuation">(</span> <span class="token string">\'remove:occupants\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> model<span class="token punctuation">,</span> coll <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\tconsole<span class="token punctuation">.</span>log<span class="token punctuation">(</span> <span class="token string">\'remove %o\'</span><span class="token punctuation">,</span> model <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\t<span class="token comment" spellcheck="true">\t// Do somehting. Destroy a View?\n</span>\t<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment" spellcheck="true">\n// Use the \'update\' event to listen for changes on a HasOne relation (like \'Person.livesIn\').\n</span>paul<span class="token punctuation">.</span>on<span class="token punctuation">(</span> <span class="token string">\'change:livesIn\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> model<span class="token punctuation">,</span> attr <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\tconsole<span class="token punctuation">.</span>log<span class="token punctuation">(</span> <span class="token string">\'change `livesIn` to %o\'</span><span class="token punctuation">,</span> attr <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token comment" spellcheck="true">\n// Modifying either side of a bi-directional relation updates the other side automatically.\n</span><span class="token comment" spellcheck="true">// Take `paul` out or `ourHouse`; this triggers `remove:occupants` on `ourHouse`,\n</span><span class="token comment" spellcheck="true">// and `change:livesIn` on `paul`\n</span>ourHouse<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'occupants\'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>remove<span class="token punctuation">(</span> paul <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nalert<span class="token punctuation">(</span> <span class="token string">\'paul.livesIn=\'</span> <span class="token operator">+</span> paul<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'livesIn\'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n    <pre class="nomargin language-javascript"><code class="runnable language-javascript" data-setup="#example-person-run2" id="example-person-run3"><span class="token comment" spellcheck="true">// Move into `theirHouse`; triggers \'add:occupants\' on ourHouse, and \'change:livesIn\' on paul\n</span>theirHouse <span class="token operator">=</span> <span class="token keyword">new</span> House<span class="token punctuation">(</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token string">\'house-2\'</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\npaul<span class="token punctuation">.</span>set<span class="token punctuation">(</span> <span class="token punctuation">{</span> <span class="token string">\'livesIn\'</span><span class="token punctuation">:</span> theirHouse <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nalert<span class="token punctuation">(</span> <span class="token string">\'theirHouse.occupants=\'</span> <span class="token operator">+</span> theirHouse<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'occupants\'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>pluck<span class="token punctuation">(</span> <span class="token string">\'name\'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n    <p>\n     This is achieved using the following relations and models:\n    </p>\n    <pre class="language-javascript"><code class="language-javascript" id="example-person">House <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>RelationalModel<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\t<span class="token comment" spellcheck="true">// The \'relations\' property, on the House\'s prototype. Initialized separately for each\n</span>\t<span class="token comment" spellcheck="true">// instance of House. Each relation must define (as a minimum) the \'type\', \'key\' and\n</span>\t<span class="token comment" spellcheck="true">// \'relatedModel\'. Options include \'includeInJSON\', \'createModels\' and \'reverseRelation\'.\n</span>\trelations<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n\t\t<span class="token punctuation">{</span>\n\t\t\ttype<span class="token punctuation">:</span> Backbone<span class="token punctuation">.</span>HasMany<span class="token punctuation">,</span> <span class="token comment" spellcheck="true">// Use the type, or the string \'HasOne\' or \'HasMany\'.\n</span>\t\t\tkey<span class="token punctuation">:</span> <span class="token string">\'occupants\'</span><span class="token punctuation">,</span>\n\t\t\trelatedModel<span class="token punctuation">:</span> <span class="token string">\'Person\'</span><span class="token punctuation">,</span>\n\t\t\tincludeInJSON<span class="token punctuation">:</span> Backbone<span class="token punctuation">.</span>Model<span class="token punctuation">.</span>prototype<span class="token punctuation">.</span>idAttribute<span class="token punctuation">,</span>\n\t\t\tcollectionType<span class="token punctuation">:</span> <span class="token string">\'PersonCollection\'</span><span class="token punctuation">,</span>\n\t\t\treverseRelation<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t\t\tkey<span class="token punctuation">:</span> <span class="token string">\'livesIn\'</span>\n\t\t\t<span class="token punctuation">}</span>\n\t\t<span class="token punctuation">}</span>\n\t<span class="token punctuation">]</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nPerson <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>RelationalModel<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\trelations<span class="token punctuation">:</span> <span class="token punctuation">[</span>\n\t\t<span class="token punctuation">{</span> <span class="token comment" spellcheck="true">// Create a (recursive) one-to-one relationship\n</span>\t\t\ttype<span class="token punctuation">:</span> Backbone<span class="token punctuation">.</span>HasOne<span class="token punctuation">,</span>\n\t\t\tkey<span class="token punctuation">:</span> <span class="token string">\'user\'</span><span class="token punctuation">,</span>\n\t\t\trelatedModel<span class="token punctuation">:</span> <span class="token string">\'User\'</span><span class="token punctuation">,</span>\n\t\t\treverseRelation<span class="token punctuation">:</span> <span class="token punctuation">{</span>\n\t\t\t\ttype<span class="token punctuation">:</span> Backbone<span class="token punctuation">.</span>HasOne<span class="token punctuation">,</span>\n\t\t\t\tkey<span class="token punctuation">:</span> <span class="token string">\'person\'</span>\n\t\t\t<span class="token punctuation">}</span>\n\t\t<span class="token punctuation">}</span>\n\t<span class="token punctuation">]</span><span class="token punctuation">,</span>\n\n\tinitialize<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token comment" spellcheck="true">// do whatever you want :)\n</span>\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nPersonCollection <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>Collection<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">{</span>\n\turl<span class="token punctuation">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span> models <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token comment" spellcheck="true">// Logic to create a url for the whole collection, or a set of models.\n</span>\t\t<span class="token comment" spellcheck="true">// See the tests, or Backbone-tastypie, for an example.\n</span>\t\t<span class="token keyword">return</span> <span class="token string">\'/person/\'</span> <span class="token operator">+</span> <span class="token punctuation">(</span> models <span class="token operator">?</span> <span class="token string">\'set/\'</span> <span class="token operator">+</span> _<span class="token punctuation">.</span>pluck<span class="token punctuation">(</span> models<span class="token punctuation">,</span> <span class="token string">\'id\'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token string">\';\'</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">\'/\'</span> <span class="token punctuation">:</span> <span class="token string">\'\'</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\nUser <span class="token operator">=</span> Backbone<span class="token punctuation">.</span>RelationalModel<span class="token punctuation">.</span>extend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n   </section>\n   <section id="change-log">\n    <h2>\n     Change Log\n    </h2>\n    <h4>\n     Master\n     <small>\n      <span class="date">\n       (future)\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.10.0...master">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/master/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <h4>\n     0.10.0\n     <small>\n      <span class="date">\n       (19 August 2015)\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.9.0...0.10.0">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.10.0/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/commit/84fae6c4ff81ce4cea40ec3345b0fdbb2f781881">\n       <q>\n        84fae6c\n       </q>\n      </a>\n      Fix ordering problems in relations\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/commit/0731ff391e3159dfac617e5834b33adef9500b49">\n       <q>\n        0731ff3\n       </q>\n      </a>\n      Backbone 1.2.1 compatible (add\n      <q>\n       _removeModels\n      </q>\n      override)\n     </li>\n    </ul>\n    <h4>\n     0.9.0\n     <small>\n      <span class="date">\n       (25 October 2014)\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.8.8...0.9.0">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.9.0/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/commit/42b158d8ad5697a955a2c1e615824109dfc52234">\n       <q>\n        42b158d\n       </q>\n      </a>\n      Add\n      <q>\n       getIdsToFetch\n      </q>\n      to\n      <q>\n       Backbone.RelationalModel\n      </q>\n      .\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/commit/b7e71237d1218eec41ce69e1cf56e5eecdc96bef">\n       <q>\n        b7e7123\n       </q>\n      </a>\n      <q>\n       getAsync\n      </q>\n      (the successor of\n      <q>\n       fetchRelated\n      </q>\n      ) now return a single promise, instead of an array of request objects.\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/467">\n       <q>\n        #467\n       </q>\n      </a>\n      :\n\t\t\t\tImprove lazy loading implemenatation. Add\n      <q>\n       getAsync\n      </q>\n      to\n      <q>\n       Backbone.RelationalModel\n      </q>\n      , which always\n\t\t\t\treturn a single promise that resolves with the attribute\'s content, and remove\n      <q>\n       fetchRelated\n      </q>\n      .\n     </li>\n    </ul>\n    <h4>\n     0.8.8\n     <small>\n      <span class="date">\n       (1 April 2014)\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.8.7...0.8.8">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.8.8/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/411">\n       <q>\n        #411\n       </q>\n      </a>\n      :\n\t\t\t\tDon\'t add models without an id to the store.\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/419">\n       <q>\n        #419\n       </q>\n      </a>\n      :\n\t\t\t\tProper return values for single models on collection methods for Backbone 1.1.0\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/commit/4113c69d3752fcac75f7a1959c77349dd4672afa">\n       <q>\n        4113c69\n       </q>\n      </a>\n      `Backbone.Relational.store.unregister` now also accepts a collection or a model type\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/427">\n       <q>\n        #427\n       </q>\n      </a>\n      :\n\t\t\t\tFix firing explicit change events\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/215">\n       <q>\n        #215\n       </q>\n      </a>\n      Add direct support for AMD, CommonJS, require, etc.\n     </li>\n    </ul>\n    <h4>\n     0.8.7\n     <small>\n      <span class="date">\n       (17 January 2014)\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.8.6...0.8.7">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.8.7/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/commit/8371089ac8bb92a00c2de38822fea7fa9f555b04">\n       <q>\n        8371089\n       </q>\n      </a>\n      :\n\t\t\t\tChange return types for\n      <q>\n       Collection\n      </q>\n      methods to match Backbone 1.1.0\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/pull/376">\n       <q>\n        #376\n       </q>\n      </a>\n      :\n\t\t\t\tInclude ids of unregistered models (not fetched or otherwise) in\n      <q>\n       toJSON\n      </q>\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/commit/8371089ac8bb92a00c2de38822fea7fa9f555b04">\n       <q>\n        8371089\n       </q>\n      </a>\n      :\n\t\t\t\tAdd\n      <q>\n       findModel\n      </q>\n      .\n     </li>\n    </ul>\n    <h4>\n     0.8.6\n     <small>\n      <span class="date">\n       (16 August 2013)\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.8.5...0.8.6">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.8.6/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/pull/322">\n       <q>\n        #322\n       </q>\n      </a>\n      :\n\t\t\t\tRemove\n      <q>\n       keySource\n      </q>\n      after a\n      <q>\n       set\n      </q>\n      as well.\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/pull/345">\n       <q>\n        #345\n       </q>\n      </a>\n      :\n\t\t\t\tAdd\n      <a href="#RelationalModel-find">\n       <q>\n        find\n       </q>\n      </a>\n      , a shortcut to\n      <q>\n       findOrCreate\n      </q>\n      with\n      <q>\n       create: false\n      </q>\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/pull/345">\n       <q>\n        #345\n       </q>\n      </a>\n      :\n\t\t\t\tAdd lodash compatibility (doesn\'t have an explicit\n      <q>\n       findWhere\n      </q>\n      ).\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/pull/349">\n       <q>\n        #349\n       </q>\n      </a>\n      :\n\t\t\t\tEvent ordering: maintain the originally intended order when process gets called more than once.\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/pull/362">\n       <q>\n        #362\n       </q>\n      </a>\n      :\n\t\t\t\tAdd support for deep\n      <q>\n       subModelType\n      </q>\n      hierarchies.\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/pull/380">\n       <q>\n        #380\n       </q>\n      </a>\n      :\n\t\t\t\tFix\n      <q>\n       pop\n      </q>\n      on an empty collection.\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/pull/370">\n       <q>\n        #370\n       </q>\n      </a>\n      :\n      <q>\n       relations\n      </q>\n      can now be a property or a function.\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/commit/7f1dc51a820aa4a5e22303177cffbbc8e7c53d47">\n       <q>\n        7f1dc51\n       </q>\n      </a>\n      :\n      <q>\n       relatedModel\n      </q>\n      and\n      <q>\n       collectionType\n      </q>\n      can now be defined as a function as well.\n     </li>\n    </ul>\n    <h4>\n     0.8.5\n     <small>\n      <span class="date">\n       (10 April 2013)\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.8.0...0.8.5">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.8.5/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      Supports Backbone 1.0.0\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/191">\n       <q>\n        #191\n       </q>\n      </a>\n      :\n\t\t\t\tif\n      <q>\n       includeInJSON\n      </q>\n      is equal to the model\'s\n      <q>\n       idAttribute\n      </q>\n      , "missing" models will be included\n\t\t\t\tin the JSON to avoid data loss.\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/201">\n       <q>\n        #201\n       </q>\n      </a>\n      :\n\t\t\t\tadd\n      <q>\n       Backbone.Store.removeModelScope\n      </q>\n      method\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/273">\n       <q>\n        #273\n       </q>\n      </a>\n      :\n\t\t\t\timprove merging of relations between super/subModels.\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/295">\n       <q>\n        #295\n       </q>\n      </a>\n      :\n\t\t\t\tcheck (and error on) duplicate ids when explicitly setting the\n      <q>\n       idAttribute\n      </q>\n      .\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/320">\n       <q>\n        #320\n       </q>\n      </a>\n      :\n\t\t\t\tuse\n      <q>\n       merge: true\n      </q>\n      by default on\n      <q>\n       Collection.reset\n      </q>\n      .\n     </li>\n    </ul>\n    <h4>\n     0.8.0\n     <small>\n      <span class="date">\n       5 March 2013\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.7.1...0.8.0">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.8.0/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      General performance improvements, refactored\n      <q>\n       HasMany.onChange\n      </q>\n      to eliminate unnecessary events.\n     </li>\n     <li>\n      Implemented the\n      <q>\n       add\n      </q>\n      ,\n      <q>\n       merge\n      </q>\n      and\n      <q>\n       remove\n      </q>\n      options on\n      <q>\n       Collection.add\n      </q>\n      when working with RelationalModels.\n\t\t\t\tThis also works when using\n      <a href="#RelationalModel-set">\n       <q>\n        set\n       </q>\n      </a>\n      to change the key on nested relations.\n     </li>\n     <li>\n      The\n      <q>\n       update\n      </q>\n      option on\n      <a href="#RelationalModel-findOrCreate">\n       <q>\n        findOrCreate\n       </q>\n      </a>\n      has been\n\t\t\t\trenamed to\n      <q>\n       merge\n      </q>\n      , since its behavior corresponds with\n      <q>\n       merge\n      </q>\n      on\n      <q>\n       Collection.add\n      </q>\n      (and not with\n      <q>\n       update\n      </q>\n      on\n      <q>\n       Collection.reset\n      </q>\n      ).\n     </li>\n     <li>\n      The\n      <q>\n       update:&lt;key&gt;\n      </q>\n      event has been removed, in favor of handling everything using "standard"\n      <q>\n       change:&lt;key&gt;\n      </q>\n      events.\n     </li>\n     <li>\n      <a href="#RelationalModel-findOrCreate">\n       <q>\n        findOrCreate\n       </q>\n      </a>\n      now takes a\n      <q>\n       parse\n      </q>\n      option,\n\t\t\t\tanalogous to the Backbone.Model constructor. It defaults to\n      <q>\n       false\n      </q>\n      .\n     </li>\n     <li>\n      Added a\n      <a href="#relations-parse">\n       <q>\n        parse\n       </q>\n      </a>\n      option to relations.\n     </li>\n    </ul>\n    <h4>\n     0.7.1\n     <small>\n      <span class="date">\n       17 Januari 2013\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.7.0...0.7.1">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.7.1/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      Compatible with Backbone &gt;= 0.9.10\n     </li>\n     <li>\n      Implemented the\n      <a href="#relations-autoFetch">\n       <q>\n        autoFetch\n       </q>\n      </a>\n      property for relations.\n     </li>\n     <li>\n      Added the\n      <q>\n       update\n      </q>\n      option to\n      <a href="#RelationalModel-findOrCreate">\n       <q>\n        findOrCreate\n       </q>\n      </a>\n      .\n     </li>\n    </ul>\n    <h4>\n     0.7.0\n     <small>\n      <span class="date">\n       18 December 2012\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.6.0...0.7.0">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.7.0/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      Compatible with Backbone &gt;= 0.9.9\n     </li>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/180">\n       <q>\n        #180\n       </q>\n      </a>\n      : no longer allow\n\t\t\t\tmultiple instances of RelationalModels with the same type, and the same\n      <q>\n       id\n      </q>\n      .\n     </li>\n    </ul>\n    <h4>\n     0.6.0\n     <small>\n      <span class="date">\n       02 August 2012\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.5.0...0.6.0">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.6.0/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      <a href="https://github.com/PaulUithol/Backbone-relational/issues/60">\n       <q>\n        #60\n       </q>\n      </a>\n      :\n      <q>\n       keySource\n      </q>\n      option\n\t\t\t\tadded to relations.\n     </li>\n     <li>\n      <q>\n       keyDestination\n      </q>\n      option added to relations.\n     </li>\n     <li>\n      <q>\n       collectionOptions\n      </q>\n      option added to relations.\n     </li>\n     <li>\n      Added support for super/sub models.\n     </li>\n     <li>\n      Added\n      <q>\n       Backbone.Store.addModelScope\n      </q>\n      .\n     </li>\n    </ul>\n    <h4>\n     0.5.0\n     <small>\n      <span class="date">\n       17 February 2012\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/0.4.0...0.5.0">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.5.0/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      Update nested models properly on\n      <q>\n       Collection.add\n      </q>\n      .\n     </li>\n     <li>\n      <q>\n       collectionKey\n      </q>\n      options added to relations.\n     </li>\n     <li>\n      Support new Backbone syntax for\n      <q>\n       set\n      </q>\n      (with separate key, value arguments).\n     </li>\n     <li>\n      Initialize reverseRelations on definition, instead of on creation of the first model.\n     </li>\n    </ul>\n    <h4>\n     0.4.0\n     <small>\n      <span class="date">\n       23 July 2011\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/compare/37affc3d...0.4.0">\n       diff\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/0.4.0/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <ul>\n     <li>\n      <q>\n       update&lt;key&gt;\n      </q>\n      event added\n     </li>\n     <li>\n      Override\n      <q>\n       Backbone.Collection._add\n      </q>\n      and\n      <q>\n       Backbone.Collection._remove\n      </q>\n      so relations update properly.\n     </li>\n     <li>\n      Queue\n      <q>\n       change\n      </q>\n      and\n      <q>\n       change&lt;key&gt;\n      </q>\n      events, so they won\'t fire before relations are updated.\n     </li>\n     <li>\n      Added the\n      <q>\n       Backbone.RelationalModel.updateRelations\n      </q>\n      method.\n     </li>\n    </ul>\n    <h4>\n     First commit\n     <small>\n      <span class="date">\n       11 April 2011\n      </span>\n      \xe2\x80\x93\n      <a href="https://github.com/PaulUithol/Backbone-relational/commit/37affc3d9cbf8b9ae2a1701a3a9e7782cd606a6f#diff-1">\n       commit\n      </a>\n      \xe2\x80\x93\n      <a href="https://raw.github.com/PaulUithol/Backbone-relational/37affc3d9cbf8b9ae2a1701a3a9e7782cd606a6f/backbone-relational.js">\n       download\n      </a>\n     </small>\n    </h4>\n    <p>\n     The original version of Backbone-relational! This already contained much of the basics:\n     <q>\n      HasOne\n     </q>\n     and\n     <q>\n      HasMany\n     </q>\n     relations (including\n     <q>\n      reverseRelation\n     </q>\n     ),\n     <q>\n      Backbone.RelationalModel\n     </q>\n     and\n     <q>\n      Backbone.Store\n     </q>\n     .\n    </p>\n   </section>\n   <section id="under-the-hood">\n    <h2>\n     Under the Hood\n    </h2>\n    <h3>\n     The model Store\n    </h3>\n    <p>\n     Each\n     <strong>\n      Backbone.RelationalModel\n     </strong>\n     registers itself with\n     <strong>\n      Backbone.Relational.Store\n     </strong>\n     upon creation, and is removed from the\n     <q>\n      store\n     </q>\n     when destroyed. When creating or updating an\n\t\t\tattribute that is a key in a relation, removed related objects are notified of their\n\t\t\tremoval, and new related objects are looked up in the Store.\n    </p>\n    <p>\n     Backbone-relational only allows the existence of one model instance for each model type\n     <q>\n      id\n     </q>\n     .\n\t\t\tThis check is there to enforce there will only be one version of a model with a certain id at any given time\n\t\t\t(which is also the reason for the existence of Backbone.Relational.Store). This is necessary to enforce\n\t\t\tconsistency\tand integrity of relations.\n    </p>\n    <p>\n     If multiple versions were allowed, inadvertently manipulating or performing a save or destroy\n\t\t\ton another version of that model (which is still around on the client, and can for example still be bound\n\t\t\tto one or more views in your application, either on purpose or inadvertently) would save its state to the\n\t\t\tserver, killing its relations, and the server response would set the same (incorrect) data on the \'current\'\n\t\t\tversion of the model on the client. By then, you\'d be in trouble.\n    </p>\n    <p>\n     Therefore, Backbone-relational simply does not allow this situation to occur. This is much safer than\n\t\t\tputting the burden on the developer to always make sure every older version of a model is completely\n\t\t\tdecoupled from every other part of your application.\n\t\t\tIt might be annoying to get an error every now and then, and sometimes inconvenient to have to use the\n\t\t\tfactory method\n     <q>\n      findOrCreate\n     </q>\n     , but it\'s much better than subtle bugs that can lead to major data loss\n\t\t\tlater on in the life cycle of your application.\n    </p>\n    <h3>\n     Event queuing\n    </h3>\n    <p>\n     Most of Backbone\'s default events are queued by Backbone-relational. This can complicate debugging since\n\t\t\tit \'breaks\' the call stack, but is a necessary part of the abstraction offered by it.\n    </p>\n    <p>\n     The event queuing kicks in every time (nested) relations need to be updated as the result of calling a\n\t\t\tBackbone method that modifies a model\'s attributes: on creation, and on\n     <q>\n      set\n     </q>\n     ,\n     <q>\n      unset\n     </q>\n     , and\n     <q>\n      clear\n     </q>\n     .\n    </p>\n    <p>\n     The basic problem is that when manipulating relations, you only want the events to fire once ALL relations\n\t\t\thave been updated; also those on models one, two, or more relations away. For example, when\tyou have an\n\t\t\tevent listener on\n     <q>\n      add\n     </q>\n     , you want to be able to use the model you receive as the first argument\n\t\t\tand its relations fully instead of getting raw JS objects:\n    </p>\n    <pre class="language-javascript"><code class="runnable language-javascript" data-setup="#example-job"><span class="token keyword">var</span> p <span class="token operator">=</span> <span class="token keyword">new</span> Person<span class="token punctuation">(</span> <span class="token punctuation">{</span> id<span class="token punctuation">:</span> <span class="token string">\'p1\'</span><span class="token punctuation">,</span> name<span class="token punctuation">:</span> <span class="token string">\'Larry Page\'</span> <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n\np<span class="token punctuation">.</span>on<span class="token punctuation">(</span> <span class="token string">\'add:jobs\'</span><span class="token punctuation">,</span> <span class="token keyword">function</span><span class="token punctuation">(</span> job <span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t<span class="token comment" spellcheck="true">// Here, you want the correct person and company to be set on job, instead of plain js.\n</span>\talert<span class="token punctuation">(</span> job<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'person\'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'name\'</span> <span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">\' @ \'</span> <span class="token operator">+</span> job<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'company\'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'name\'</span> <span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n\np<span class="token punctuation">.</span>get<span class="token punctuation">(</span> <span class="token string">\'jobs\'</span> <span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token number">add</span><span class="token punctuation">(</span> <span class="token punctuation">{</span> company<span class="token punctuation">:</span> <span class="token punctuation">{</span> name<span class="token punctuation">:</span> <span class="token string">\'Google\'</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> person<span class="token punctuation">:</span> p<span class="token punctuation">.</span>id <span class="token punctuation">}</span> <span class="token punctuation">)</span><span class="token punctuation">;</span>\n</code></pre>\n    <p>\n     To achieve this, Backbone\'s events are prevented from firing\n     <i>\n      immediately\n     </i>\n     when\n     <q>\n      add\n     </q>\n     is called, but are delayed until the all (nested) relations have reached a stable state again. Events are\n\t\t\tthen fired at the first available opportunity; as soon as the last model updating its relations unblocks\n\t\t\tthe\n     <q>\n      Backbone.Relational.eventQueue\n     </q>\n     .\n    </p>\n   </section>\n  </div>\n  <div class="scripts">\n   <script src="test/lib/jquery-1.9.1.js" type="text/javascript">\n   </script>\n   <script src="test/lib/underscore.js" type="text/javascript">\n   </script>\n   <script src="test/lib/backbone.js" type="text/javascript">\n   </script>\n   <script src="backbone-relational.js" type="text/javascript">\n   </script>\n   <script src="static/js/prism.js" type="text/javascript">\n   </script>\n   <script type="text/javascript">\n    // Set up the "play" buttons for each runnable code example.\n\t$( function() {\n\t\t// Run a piece of example code. If an element has a `data-setup` attribute,\n\t\t// the element referred to gets executed first.\n\t\tfunction run( codeElem, silenceAlerts ) {\n\t\t\tcodeElem = $( codeElem );\n\n\t\t\tvar setup = codeElem.data( \'setup\' );\n\n\t\t\tif ( setup ) {\n\t\t\t\trun( setup, true );\n\t\t\t}\n\n\t\t\tif ( silenceAlerts === true ) {\n\t\t\t\tvar _alert = window.alert;\n\t\t\t\twindow.alert = $.noop;\n\t\t\t}\n\n\t\t\t// Grab the code, and eval it. Nasty twist: remove all `var` statement at the start of a line;\n\t\t\t// this will make all eval\'ed vars global, so vars from scripts used as setup can be used\n\t\t\t// by those that need \'em.\n\t\t\tvar code = $( codeElem ).text();\n\t\t\tcode = code.replace( /(^|\\n)(var )/g, \'\\n\' );\n\t\t\t//console.log( \'Executing:\\n %s\', code );\n\t\t\teval( code );\n\n\t\t\tif ( silenceAlerts === true ) {\n\t\t\t\twindow.alert = _alert;\n\t\t\t}\n\t\t}\n\n\t\t$( \'.runnable\' ).each( function() {\n\t\t\tvar code = $( this );\n\n\t\t\t// Add a `runnable` button to each runnable piece of code\n\t\t\tvar button = \'<div class="run" title="Run"><a class="button orange">&#x25BA;</a></div>\';\n\t\t\t$( button ).insertBefore( code ).bind( \'click\', function() {\n\t\t\t\tBackbone.Relational.store.reset();\n\t\t\t\trun( code );\n\t\t\t});\n\t\t});\n\t});\n   </script>\n  </div>\n </body>\n</html>'